<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libdap++: DODSFilter.cc Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>DODSFilter.cc</h1><a href="DODSFilter_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 <span class="comment">// -*- mode: c++; c-basic-offset:4 -*-</span>
00003 
00004 <span class="comment">// This file is part of libdap, A C++ implementation of the OPeNDAP Data</span>
00005 <span class="comment">// Access Protocol.</span>
00006 
00007 <span class="comment">// Copyright (c) 2002,2003 OPeNDAP, Inc.</span>
00008 <span class="comment">// Author: James Gallagher &lt;jgallagher@opendap.org&gt;</span>
00009 <span class="comment">//</span>
00010 <span class="comment">// This library is free software; you can redistribute it and/or</span>
00011 <span class="comment">// modify it under the terms of the GNU Lesser General Public</span>
00012 <span class="comment">// License as published by the Free Software Foundation; either</span>
00013 <span class="comment">// version 2.1 of the License, or (at your option) any later version.</span>
00014 <span class="comment">// </span>
00015 <span class="comment">// This library is distributed in the hope that it will be useful,</span>
00016 <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00017 <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
00018 <span class="comment">// Lesser General Public License for more details.</span>
00019 <span class="comment">// </span>
00020 <span class="comment">// You should have received a copy of the GNU Lesser General Public</span>
00021 <span class="comment">// License along with this library; if not, write to the Free Software</span>
00022 <span class="comment">// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00023 <span class="comment">//</span>
00024 <span class="comment">// You can contact OPeNDAP, Inc. at PO Box 112, Saunderstown, RI. 02874-0112.</span>
00025  
00026 <span class="comment">// (c) COPYRIGHT URI/MIT 1997-1999</span>
00027 <span class="comment">// Please read the full copyright statement in the file COPYRIGHT_URI.</span>
00028 <span class="comment">//</span>
00029 <span class="comment">// Authors:</span>
00030 <span class="comment">//      jhrg,jimg       James Gallagher &lt;jgallagher@gso.uri.edu&gt;</span>
00031 
00032 <span class="comment">// Implementation of the DODSFilter class. This class is used to build dods</span>
00033 <span class="comment">// filter programs which, along with a CGI program, comprise DODS servers.</span>
00034 <span class="comment">// jhrg 8/26/97</span>
00035 
00036 <span class="preprocessor">#ifdef __GNUG__</span>
00037 <span class="preprocessor"></span><span class="preprocessor">#pragma implementation</span>
00038 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00039 <span class="preprocessor"></span>
00040 <span class="preprocessor">#include "<a class="code" href="config__dap_8h.html">config_dap.h</a>"</span>
00041 
00042 <span class="keyword">static</span> <span class="keywordtype">char</span> rcsid[] <a class="code" href="config__dap_8h.html#a49">not_used</a> = {<span class="stringliteral">"$Id$"</span>};
00043 
00044 <span class="preprocessor">#include &lt;signal.h&gt;</span>
00045 
00046 <span class="preprocessor">#ifndef WIN32</span>
00047 <span class="preprocessor"></span><span class="preprocessor">#include &lt;unistd.h&gt;</span>
00048 <span class="preprocessor">#include &lt;sys/wait.h&gt;</span>
00049 <span class="preprocessor">#else</span>
00050 <span class="preprocessor"></span><span class="preprocessor">#include &lt;io.h&gt;</span>
00051 <span class="preprocessor">#include &lt;fcntl.h&gt;</span>
00052 <span class="preprocessor">#include &lt;process.h&gt;</span>
00053 <span class="preprocessor">#endif</span>
00054 <span class="preprocessor"></span> 
00055 <span class="preprocessor">#include &lt;iostream&gt;</span>
00056 <span class="preprocessor">#include &lt;string&gt;</span>
00057 <span class="preprocessor">#include &lt;algorithm&gt;</span>
00058 
00059 <span class="preprocessor">#include &lt;GetOpt.h&gt;</span>
00060 
00061 <span class="preprocessor">#include "<a class="code" href="DAS_8h.html">DAS.h</a>"</span>
00062 <span class="preprocessor">#include "<a class="code" href="DDS_8h.html">DDS.h</a>"</span>
00063 <span class="preprocessor">#include "<a class="code" href="debug_8h.html">debug.h</a>"</span>
00064 <span class="preprocessor">#include "<a class="code" href="cgi__util_8h.html">cgi_util.h</a>"</span>
00065 <span class="preprocessor">#include "<a class="code" href="util_8h.html">util.h</a>"</span>
00066 <span class="preprocessor">#include "<a class="code" href="escaping_8h.html">escaping.h</a>"</span>
00067 <span class="preprocessor">#include "<a class="code" href="DODSFilter_8h.html">DODSFilter.h</a>"</span>
00068 <span class="preprocessor">#include "<a class="code" href="InternalErr_8h.html">InternalErr.h</a>"</span>
00069 <span class="preprocessor">#ifndef WIN32</span>
00070 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="SignalHandler_8h.html">SignalHandler.h</a>"</span>
00071 <span class="preprocessor">#include "<a class="code" href="EventHandler_8h.html">EventHandler.h</a>"</span>
00072 <span class="preprocessor">#endif</span>
00073 <span class="preprocessor"></span>
00074 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00075 
00076 <span class="preprocessor">#ifdef WIN32</span>
00077 <span class="preprocessor"></span><span class="preprocessor">#define WAITPID(pid) while(_cwait(NULL, pid, NULL) &gt; 0)</span>
00078 <span class="preprocessor"></span><span class="preprocessor">#else</span>
<a name="l00079"></a><a class="code" href="DODSFilter_8cc.html#a0">00079</a> <span class="preprocessor"></span><span class="preprocessor">#define WAITPID(pid) while(waitpid(pid, 0, 0) &gt; 0)</span>
00080 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00081 <span class="preprocessor"></span>
<a name="l00149"></a><a class="code" href="classDODSFilter.html#DODSFiltera0">00149</a> <a class="code" href="classDODSFilter.html#DODSFilterb0">DODSFilter::DODSFilter</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) 
00150 {
00151     <a class="code" href="classDODSFilter.html#DODSFilterb1">initialize</a>(argc, argv);
00152 }
00153 
<a name="l00154"></a><a class="code" href="classDODSFilter.html#DODSFiltera1">00154</a> <a class="code" href="classDODSFilter.html#DODSFiltera1">DODSFilter::~DODSFilter</a>()
00155 {
00156 }
00157 
00168 <span class="keywordtype">void</span>
<a name="l00169"></a><a class="code" href="classDODSFilter.html#DODSFilterb1">00169</a> <a class="code" href="classDODSFilter.html#DODSFilterb1">DODSFilter::initialize</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])
00170 {
00171     <span class="comment">// Set default values. Don't use the C++ constructor initialization so</span>
00172     <span class="comment">// that a subclass can have more control over this process.</span>
00173     <a class="code" href="classDODSFilter.html#DODSFilterp0">d_comp</a> = <span class="keyword">false</span>;
00174     <a class="code" href="classDODSFilter.html#DODSFilterp1">d_ver</a> = <span class="keyword">false</span>; 
00175     <a class="code" href="classDODSFilter.html#DODSFilterp2">d_bad_options</a> = <span class="keyword">false</span>; 
00176     <a class="code" href="classDODSFilter.html#DODSFilterp3">d_conditional_request</a> = <span class="keyword">false</span>;
00177     <a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a> = <span class="stringliteral">""</span>;
00178     <a class="code" href="classDODSFilter.html#DODSFilterp6">d_ce</a> = <span class="stringliteral">""</span>;
00179     <a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a> = <span class="stringliteral">""</span>;
00180     <a class="code" href="classDODSFilter.html#DODSFilterp8">d_anc_dir</a> = <span class="stringliteral">""</span>;
00181     <a class="code" href="classDODSFilter.html#DODSFilterp9">d_anc_file</a> = <span class="stringliteral">""</span>;
00182     <a class="code" href="classDODSFilter.html#DODSFilterp10">d_cache_dir</a> = <span class="stringliteral">""</span>;
00183     <a class="code" href="classDODSFilter.html#DODSFilterp12">d_anc_das_lmt</a> = 0; 
00184     <a class="code" href="classDODSFilter.html#DODSFilterp13">d_anc_dds_lmt</a> = 0;
00185     <a class="code" href="classDODSFilter.html#DODSFilterp14">d_if_modified_since</a> = -1;
00186 
00187     <a class="code" href="classDODSFilter.html#DODSFilterp4">d_program_name</a> = argv[0];
00188 
00189     <a class="code" href="classDODSFilter.html#DODSFilterp11">d_timeout</a> = 0;
00190 
00191     <span class="comment">// This should be specialized by a subclass.</span>
00192     <span class="keywordtype">int</span> next_arg = <a class="code" href="classDODSFilter.html#DODSFilterb2">process_options</a>(argc, argv);
00193 
00194     <span class="comment">// Look at what's left after processing the command line options. Either</span>
00195     <span class="comment">// there MUST be a dataset name OR the caller is asking for version</span>
00196     <span class="comment">// information. If neither is true, then the options are bad.</span>
00197     <span class="keywordflow">if</span>(next_arg &lt; argc)
00198     <a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a> = argv[next_arg];
00199     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classDODSFilter.html#DODSFilterp1">d_ver</a>)        
00200     <a class="code" href="classDODSFilter.html#DODSFilterp2">d_bad_options</a> = <span class="keyword">true</span>;
00201 
00202     <span class="comment">// Both dataset and ce could be set at this point (dataset must be, ce</span>
00203     <span class="comment">// might be). If they contain any WWW-style esacpes (%&lt;hex digit&gt;,hex</span>
00204     <span class="comment">// digit&gt;) then undo that escaping.</span>
00205     <a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a> = <a class="code" href="escaping_8cc.html#a7">www2id</a>(<a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a>, <span class="stringliteral">"%"</span>, <span class="stringliteral">"%20"</span>);
00206     <a class="code" href="classDODSFilter.html#DODSFilterp6">d_ce</a> = <a class="code" href="escaping_8cc.html#a7">www2id</a>(<a class="code" href="classDODSFilter.html#DODSFilterp6">d_ce</a>, <span class="stringliteral">"%"</span>, <span class="stringliteral">"%20"</span>);
00207 
00208     <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"d_comp: "</span> &lt;&lt; <a class="code" href="classDODSFilter.html#DODSFilterp0">d_comp</a> &lt;&lt; endl);
00209     <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"d_ce: "</span> &lt;&lt; <a class="code" href="classDODSFilter.html#DODSFilterp6">d_ce</a> &lt;&lt; endl);
00210     <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"d_cgi_ver: "</span> &lt;&lt; <a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a> &lt;&lt; endl);
00211     <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"d_ver: "</span> &lt;&lt; <a class="code" href="classDODSFilter.html#DODSFilterp1">d_ver</a> &lt;&lt; endl);
00212     <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"d_anc_dir: "</span> &lt;&lt; <a class="code" href="classDODSFilter.html#DODSFilterp8">d_anc_dir</a> &lt;&lt; endl);
00213     <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"d_anc_file: "</span> &lt;&lt; <a class="code" href="classDODSFilter.html#DODSFilterp9">d_anc_file</a> &lt;&lt; endl);
00214     <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"d_cache_dir: "</span> &lt;&lt; <a class="code" href="classDODSFilter.html#DODSFilterp10">d_cache_dir</a> &lt;&lt; endl);
00215     <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"d_conditional_request: "</span> &lt;&lt; <a class="code" href="classDODSFilter.html#DODSFilterp3">d_conditional_request</a> &lt;&lt; endl);
00216     <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"d_if_modified_since: "</span> &lt;&lt; <a class="code" href="classDODSFilter.html#DODSFilterp14">d_if_modified_since</a> &lt;&lt; endl);
00217     <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"d_timeout: "</span> &lt;&lt; <a class="code" href="classDODSFilter.html#DODSFilterp11">d_timeout</a> &lt;&lt; endl);
00218 }
00219 
00228 <span class="keywordtype">int</span>
<a name="l00229"></a><a class="code" href="classDODSFilter.html#DODSFilterb2">00229</a> <a class="code" href="classDODSFilter.html#DODSFilterb2">DODSFilter::process_options</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])
00230 {
00231     <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"Entering process_options... "</span>);
00232 
00233     <span class="keywordtype">int</span> option_char;
00234     GetOpt getopt (argc, argv, <span class="stringliteral">"ce:v:Vd:f:r:t:l:"</span>);
00235 
00236     <span class="keywordflow">while</span> ((option_char = getopt()) != EOF) {
00237     <span class="keywordflow">switch</span> (option_char) {
00238       <span class="keywordflow">case</span> <span class="charliteral">'c'</span>: <a class="code" href="classDODSFilter.html#DODSFilterp0">d_comp</a> = <span class="keyword">true</span>; <span class="keywordflow">break</span>;
00239       <span class="keywordflow">case</span> <span class="charliteral">'e'</span>: <a class="code" href="classDODSFilter.html#DODSFilterp6">d_ce</a> = getopt.optarg; <span class="keywordflow">break</span>;
00240       <span class="keywordflow">case</span> <span class="charliteral">'v'</span>: <a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a> = getopt.optarg; <span class="keywordflow">break</span>;
00241       <span class="keywordflow">case</span> <span class="charliteral">'V'</span>: <a class="code" href="classDODSFilter.html#DODSFilterp1">d_ver</a> = <span class="keyword">true</span>; <span class="keywordflow">break</span>;
00242       <span class="keywordflow">case</span> <span class="charliteral">'d'</span>: <a class="code" href="classDODSFilter.html#DODSFilterp8">d_anc_dir</a> = getopt.optarg; <span class="keywordflow">break</span>;
00243       <span class="keywordflow">case</span> <span class="charliteral">'f'</span>: <a class="code" href="classDODSFilter.html#DODSFilterp9">d_anc_file</a> = getopt.optarg; <span class="keywordflow">break</span>;
00244       <span class="keywordflow">case</span> <span class="charliteral">'r'</span>: <a class="code" href="classDODSFilter.html#DODSFilterp10">d_cache_dir</a> = getopt.optarg; <span class="keywordflow">break</span>;
00245       <span class="keywordflow">case</span> <span class="charliteral">'t'</span>: <a class="code" href="classDODSFilter.html#DODSFilterp11">d_timeout</a> = atoi(getopt.optarg); <span class="keywordflow">break</span>;
00246       <span class="keywordflow">case</span> <span class="charliteral">'l'</span>: 
00247         <a class="code" href="classDODSFilter.html#DODSFilterp3">d_conditional_request</a> = <span class="keyword">true</span>;
00248         <a class="code" href="classDODSFilter.html#DODSFilterp14">d_if_modified_since</a> 
00249         = static_cast&lt;time_t&gt;(strtol(getopt.optarg, NULL, 10));
00250         <span class="keywordflow">break</span>;
00251       <span class="keywordflow">default</span>: <a class="code" href="classDODSFilter.html#DODSFilterp2">d_bad_options</a> = <span class="keyword">true</span>; <span class="keywordflow">break</span>;
00252     }
00253     }
00254 
00255     <a class="code" href="debug_8h.html#a2">DBGN</a>(cerr &lt;&lt; <span class="stringliteral">"exiting."</span> &lt;&lt; endl);
00256 
00257     <span class="keywordflow">return</span> getopt.optind;   <span class="comment">// return the index of the next argument</span>
00258 }
00259 
00264 <span class="keywordtype">bool</span>
<a name="l00265"></a><a class="code" href="classDODSFilter.html#DODSFiltera4">00265</a> <a class="code" href="classDODSFilter.html#DODSFiltera4">DODSFilter::is_conditional</a>()
00266 {
00267     <span class="keywordflow">return</span> <a class="code" href="classDODSFilter.html#DODSFilterp3">d_conditional_request</a>;
00268 }
00269 
00283 <span class="keywordtype">void</span>
<a name="l00284"></a><a class="code" href="classDODSFilter.html#DODSFiltera6">00284</a> <a class="code" href="classDODSFilter.html#DODSFiltera6">DODSFilter::set_cgi_version</a>(string version)
00285 {
00286     <a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a> = <a class="code" href="das-test_8cc.html#a4">version</a>;
00287 }
00288 
00294 string
<a name="l00295"></a><a class="code" href="classDODSFilter.html#DODSFiltera5">00295</a> <a class="code" href="classDODSFilter.html#DODSFiltera5">DODSFilter::get_cgi_version</a>()
00296 {
00297     <span class="keywordflow">return</span> <a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a>;
00298 }
00299 
00306 string
<a name="l00307"></a><a class="code" href="classDODSFilter.html#DODSFiltera7">00307</a> <a class="code" href="classDODSFilter.html#DODSFiltera7">DODSFilter::get_ce</a>()
00308 {
00309     <span class="keywordflow">return</span> <a class="code" href="classDODSFilter.html#DODSFilterp6">d_ce</a>;
00310 }
00311 
00312 <span class="keywordtype">void</span>
<a name="l00313"></a><a class="code" href="classDODSFilter.html#DODSFiltera8">00313</a> <a class="code" href="classDODSFilter.html#DODSFiltera8">DODSFilter::set_ce</a>(string _ce)
00314 {
00315     <a class="code" href="classDODSFilter.html#DODSFilterp6">d_ce</a> = <a class="code" href="escaping_8cc.html#a7">www2id</a>(_ce, <span class="stringliteral">"%"</span>, <span class="stringliteral">"%20"</span>);
00316 }
00317 
00326 string
<a name="l00327"></a><a class="code" href="classDODSFilter.html#DODSFiltera9">00327</a> <a class="code" href="classDODSFilter.html#DODSFiltera9">DODSFilter::get_dataset_name</a>()
00328 {
00329     <span class="keywordflow">return</span> <a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a>;
00330 }
00331 
00332 <span class="keywordtype">void</span>
<a name="l00333"></a><a class="code" href="classDODSFilter.html#DODSFiltera10">00333</a> <a class="code" href="classDODSFilter.html#DODSFiltera10">DODSFilter::set_dataset_name</a>(<span class="keyword">const</span> string ds)
00334 {
00335   <a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a> = ds;
00336 }
00337 
00345 string
<a name="l00346"></a><a class="code" href="classDODSFilter.html#DODSFiltera11">00346</a> <a class="code" href="classDODSFilter.html#DODSFiltera11">DODSFilter::get_dataset_version</a>()
00347 {
00348     <span class="keywordflow">return</span> <span class="stringliteral">""</span>;
00349 }
00350 
00371 time_t
<a name="l00372"></a><a class="code" href="classDODSFilter.html#DODSFiltera12">00372</a> <a class="code" href="classDODSFilter.html#DODSFiltera12">DODSFilter::get_dataset_last_modified_time</a>()
00373 {
00374     <span class="keywordflow">return</span> <a class="code" href="cgi__util_8cc.html#a15">last_modified_time</a>(<a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a>);
00375 }
00376 
00386 time_t
<a name="l00387"></a><a class="code" href="classDODSFilter.html#DODSFiltera13">00387</a> <a class="code" href="classDODSFilter.html#DODSFiltera13">DODSFilter::get_das_last_modified_time</a>(<span class="keyword">const</span> string &amp;anc_location)
00388 {
00389     string name = <a class="code" href="cgi__util_8cc.html#a10">find_ancillary_file</a>(<a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a>, <span class="stringliteral">"das"</span>, anc_location, <a class="code" href="classDODSFilter.html#DODSFilterp9">d_anc_file</a>);
00390     <span class="keywordflow">return</span> max((name != <span class="stringliteral">""</span>) ? <a class="code" href="cgi__util_8cc.html#a15">last_modified_time</a>(name) : 0,
00391            <a class="code" href="classDODSFilter.html#DODSFiltera12">get_dataset_last_modified_time</a>()); 
00392 }
00393 
00401 time_t
<a name="l00402"></a><a class="code" href="classDODSFilter.html#DODSFiltera14">00402</a> <a class="code" href="classDODSFilter.html#DODSFiltera14">DODSFilter::get_dds_last_modified_time</a>(<span class="keyword">const</span> string &amp;anc_location)
00403 {
00404     string name = <a class="code" href="cgi__util_8cc.html#a10">find_ancillary_file</a>(<a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a>, <span class="stringliteral">"dds"</span>, anc_location, <a class="code" href="classDODSFilter.html#DODSFilterp9">d_anc_file</a>);
00405     <span class="keywordflow">return</span> max((name != <span class="stringliteral">""</span>) ? <a class="code" href="cgi__util_8cc.html#a15">last_modified_time</a>(name) : 0,
00406            <a class="code" href="classDODSFilter.html#DODSFiltera12">get_dataset_last_modified_time</a>()); 
00407 }
00408 
00422 time_t
<a name="l00423"></a><a class="code" href="classDODSFilter.html#DODSFiltera15">00423</a> <a class="code" href="classDODSFilter.html#DODSFiltera15">DODSFilter::get_data_last_modified_time</a>(<span class="keyword">const</span> string &amp;anc_location)
00424 {
00425     string dds_name = <a class="code" href="cgi__util_8cc.html#a10">find_ancillary_file</a>(<a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a>, <span class="stringliteral">"dds"</span>, anc_location,
00426                       <a class="code" href="classDODSFilter.html#DODSFilterp9">d_anc_file</a>);
00427     string das_name = <a class="code" href="cgi__util_8cc.html#a10">find_ancillary_file</a>(<a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a>, <span class="stringliteral">"dds"</span>, anc_location,
00428                       <a class="code" href="classDODSFilter.html#DODSFilterp9">d_anc_file</a>);
00429     time_t m = max((das_name != <span class="stringliteral">""</span>) ? <a class="code" href="cgi__util_8cc.html#a15">last_modified_time</a>(das_name) : (time_t)0,
00430            (dds_name != <span class="stringliteral">""</span>) ? <a class="code" href="cgi__util_8cc.html#a15">last_modified_time</a>(dds_name) : (time_t)0);
00431     <span class="comment">// Note that this is a call to get_dataset_... not get_data_...</span>
00432     time_t n = <a class="code" href="classDODSFilter.html#DODSFiltera12">get_dataset_last_modified_time</a>();
00433 
00434     <span class="keywordflow">return</span> max(m, n); 
00435 }
00436 
00444 time_t
<a name="l00445"></a><a class="code" href="classDODSFilter.html#DODSFiltera16">00445</a> <a class="code" href="classDODSFilter.html#DODSFiltera16">DODSFilter::get_request_if_modified_since</a>()
00446 {
00447     <span class="keywordflow">return</span> <a class="code" href="classDODSFilter.html#DODSFilterp14">d_if_modified_since</a>;
00448 }
00449 
00456 string
<a name="l00457"></a><a class="code" href="classDODSFilter.html#DODSFiltera17">00457</a> <a class="code" href="classDODSFilter.html#DODSFiltera17">DODSFilter::get_cache_dir</a>()
00458 {
00459   <span class="keywordflow">return</span> <a class="code" href="classDODSFilter.html#DODSFilterp10">d_cache_dir</a>;
00460 }
00461 
00466 <span class="keywordtype">void</span> 
<a name="l00467"></a><a class="code" href="classDODSFilter.html#DODSFiltera18">00467</a> <a class="code" href="classDODSFilter.html#DODSFiltera18">DODSFilter::set_timeout</a>(<span class="keywordtype">int</span> t)
00468 {
00469     <a class="code" href="classDODSFilter.html#DODSFilterp11">d_timeout</a> = t;
00470 }
00471 
00473 <span class="keywordtype">int</span>
<a name="l00474"></a><a class="code" href="classDODSFilter.html#DODSFiltera19">00474</a> <a class="code" href="classDODSFilter.html#DODSFiltera19">DODSFilter::get_timeout</a>()<span class="keyword"> const</span>
00475 <span class="keyword"></span>{
00476     <span class="keywordflow">return</span> <a class="code" href="classDODSFilter.html#DODSFilterp11">d_timeout</a>;
00477 }
00478 
00487 <span class="keywordtype">void</span>
<a name="l00488"></a><a class="code" href="classDODSFilter.html#DODSFiltera20">00488</a> <a class="code" href="classDODSFilter.html#DODSFiltera20">DODSFilter::establish_timeout</a>(FILE *stream)
00489 {
00490 <span class="preprocessor">#ifndef WIN32</span>
00491 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="classDODSFilter.html#DODSFilterp11">d_timeout</a> &gt; 0) {
00492     <a class="code" href="classSignalHandler.html">SignalHandler</a> *sh = <a class="code" href="classSignalHandler.html#SignalHandlere0">SignalHandler::instance</a>();
00493     sh-&gt;<a class="code" href="classSignalHandler.html#SignalHandlera0">register_handler</a>(SIGALRM, <span class="keyword">new</span> <a class="code" href="classAlarmHandler.html">AlarmHandler</a>(stream));
00494     alarm(<a class="code" href="classDODSFilter.html#DODSFilterp11">d_timeout</a>);
00495     }
00496 <span class="preprocessor">#endif</span>
00497 <span class="preprocessor"></span>}
00498 
00499 
00509 <span class="keywordtype">void</span>
<a name="l00510"></a><a class="code" href="classDODSFilter.html#DODSFiltera21">00510</a> <a class="code" href="classDODSFilter.html#DODSFiltera21">DODSFilter::read_ancillary_das</a>(<a class="code" href="classDAS.html">DAS</a> &amp;das, string anc_location)
00511 {
00512     string name = <a class="code" href="cgi__util_8cc.html#a10">find_ancillary_file</a>(<a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a>, <span class="stringliteral">"das"</span>, 
00513                   (anc_location == <span class="stringliteral">""</span>) ? <a class="code" href="classDODSFilter.html#DODSFilterp8">d_anc_dir</a> : anc_location, 
00514                       <a class="code" href="classDODSFilter.html#DODSFilterp9">d_anc_file</a>);
00515 
00516     FILE *in = fopen(name.c_str(), <span class="stringliteral">"r"</span>);
00517     <span class="keywordflow">if</span> (in) {
00518     das.<a class="code" href="classDAS.html#DASz19_0">parse</a>(in);
00519     <span class="keywordtype">int</span> res = fclose( in ) ;
00520     <span class="keywordflow">if</span>( res ) {
00521         <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"DODSFilter::read_ancillary_das - Failed to close file "</span> &lt;&lt; (<span class="keywordtype">void</span> *)in &lt;&lt; endl ;) ;
00522     }
00523     }
00524 }
00525 
00535 <span class="keywordtype">void</span>
<a name="l00536"></a><a class="code" href="classDODSFilter.html#DODSFiltera22">00536</a> <a class="code" href="classDODSFilter.html#DODSFiltera22">DODSFilter::read_ancillary_dds</a>(<a class="code" href="classDDS.html">DDS</a> &amp;dds, string anc_location)
00537 {
00538     string name = <a class="code" href="cgi__util_8cc.html#a10">find_ancillary_file</a>(<a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a>, <span class="stringliteral">"dds"</span>, 
00539                   (anc_location == <span class="stringliteral">""</span>) ? <a class="code" href="classDODSFilter.html#DODSFilterp8">d_anc_dir</a> : anc_location, 
00540                       <a class="code" href="classDODSFilter.html#DODSFilterp9">d_anc_file</a>);
00541     FILE *in = fopen(name.c_str(), <span class="stringliteral">"r"</span>);
00542     <span class="keywordflow">if</span> (in) {
00543     dds.<a class="code" href="classDDS.html#DDSa40">parse</a>(in);
00544     <span class="keywordtype">int</span> res = fclose( in ) ;
00545     <span class="keywordflow">if</span>( res ) {
00546         <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"DODSFilter::read_ancillary_dds - Failed to close "</span> &lt;&lt; (<span class="keywordtype">void</span> *)in &lt;&lt; endl ;) ;
00547     }
00548     }
00549 }
00550 
00551 <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *emessage = \
00552 <span class="stringliteral">"DODS internal server error; usage error. Please report this to the dataset \</span>
00553 <span class="stringliteral">maintainer, or to support@unidata.ucar.edu."</span>;
00554 
00565 <span class="keywordtype">void</span> 
<a name="l00566"></a><a class="code" href="classDODSFilter.html#DODSFiltera23">00566</a> <a class="code" href="classDODSFilter.html#DODSFiltera23">DODSFilter::print_usage</a>()
00567 {
00568     <span class="comment">// Write a message to the WWW server error log file.</span>
00569     string oss=<span class="stringliteral">""</span>;
00570     oss+= <span class="stringliteral">"Usage: "</span> + <a class="code" href="classDODSFilter.html#DODSFilterp4">d_program_name</a> + <span class="stringliteral">" -V | [-c] [-v &lt;cgi version&gt;] [-e &lt;ce&gt;]\n"</span>;
00571     oss+= <span class="stringliteral">"       [-d &lt;ancillary file directory&gt;] [-f &lt;ancillary file name&gt;]\n"</span>;
00572     oss+= <span class="stringliteral">"       &lt;dataset&gt;\n"</span>;
00573     <a class="code" href="cgi__util_8cc.html#a12">ErrMsgT</a>(oss.c_str());
00574 
00575     <span class="keywordflow">throw</span> <a class="code" href="classError.html">Error</a>(<a class="code" href="Error_8h.html#a1">unknown_error</a>, emessage);
00576 }
00577 
00583 <span class="keywordtype">void</span> 
<a name="l00584"></a><a class="code" href="classDODSFilter.html#DODSFiltera24">00584</a> <a class="code" href="classDODSFilter.html#DODSFiltera24">DODSFilter::send_version_info</a>()
00585 {
00586     fprintf( stdout, <span class="stringliteral">"HTTP/1.0 200 OK\n"</span> ) ;
00587     fprintf( stdout, <span class="stringliteral">"XDODS-Server: %s\n"</span>, <a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a>.c_str() ) ;
00588     fprintf( stdout, <span class="stringliteral">"Content-Type: text/plain\n"</span> ) ;
00589     fprintf( stdout, <span class="stringliteral">"\n"</span> ) ;
00590 
00591     fprintf( stdout, <span class="stringliteral">"DODS server core software: %s\n"</span>, <a class="code" href="config__dap_8h.html#a11">DVR</a> ) ;
00592 
00593     <span class="keywordflow">if</span> (<a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a> != <span class="stringliteral">""</span>)
00594     fprintf( stdout, <span class="stringliteral">"Server vision: %s\n"</span>, <a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a>.c_str() ) ;
00595 
00596     string v = <a class="code" href="classDODSFilter.html#DODSFiltera11">get_dataset_version</a>();
00597     <span class="keywordflow">if</span> (v != <span class="stringliteral">""</span>)
00598     fprintf( stdout, <span class="stringliteral">"Dataset version: %s\n"</span>, v.c_str() ) ;
00599     
00600     fflush( stdout ) ;
00601 }
00602 
00603 <span class="comment">// I've written a few unit tests for this method (see DODSFilterTest.cc) but</span>
00604 <span class="comment">// it's very hard to test well. 5/1/2001 jhrg</span>
00615 <span class="comment"></span><span class="keywordtype">void</span>
<a name="l00616"></a><a class="code" href="classDODSFilter.html#DODSFiltera26">00616</a> <a class="code" href="classDODSFilter.html#DODSFiltera25">DODSFilter::send_das</a>(ostream &amp;os, <a class="code" href="classDAS.html">DAS</a> &amp;das, <span class="keyword">const</span> string &amp;anc_location)
00617 {
00618     time_t das_lmt = <a class="code" href="classDODSFilter.html#DODSFiltera13">get_das_last_modified_time</a>(anc_location);
00619     <span class="keywordflow">if</span> (<a class="code" href="classDODSFilter.html#DODSFiltera4">is_conditional</a>()
00620     &amp;&amp; das_lmt &lt;= <a class="code" href="classDODSFilter.html#DODSFiltera16">get_request_if_modified_since</a>()) {
00621     <a class="code" href="cgi__util_8cc.html#a22">set_mime_not_modified</a>(os);
00622     }
00623     <span class="keywordflow">else</span> {
00624     <a class="code" href="cgi__util_8cc.html#a16">set_mime_text</a>(os, <a class="code" href="ObjectType_8h.html#a6a1">dods_das</a>, <a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a>, <a class="code" href="EncodingType_8h.html#a3a2">x_plain</a>, das_lmt);
00625     das.<a class="code" href="classDAS.html#DASa9">print</a>(os);
00626     }
00627 }
00628 
00629 <span class="keywordtype">void</span>
<a name="l00630"></a><a class="code" href="classDODSFilter.html#DODSFiltera27">00630</a> <a class="code" href="classDODSFilter.html#DODSFiltera25">DODSFilter::send_das</a>(FILE *out, <a class="code" href="classDAS.html">DAS</a> &amp;das, <span class="keyword">const</span> string &amp;anc_location)
00631 {
00632     time_t das_lmt = <a class="code" href="classDODSFilter.html#DODSFiltera13">get_das_last_modified_time</a>(anc_location);
00633     <span class="keywordflow">if</span> (<a class="code" href="classDODSFilter.html#DODSFiltera4">is_conditional</a>()
00634     &amp;&amp; das_lmt &lt;= <a class="code" href="classDODSFilter.html#DODSFiltera16">get_request_if_modified_since</a>()) {
00635     <a class="code" href="cgi__util_8cc.html#a22">set_mime_not_modified</a>(out);
00636     }
00637     <span class="keywordflow">else</span> {
00638     <a class="code" href="cgi__util_8cc.html#a16">set_mime_text</a>(out, <a class="code" href="ObjectType_8h.html#a6a1">dods_das</a>, <a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a>, <a class="code" href="EncodingType_8h.html#a3a2">x_plain</a>, das_lmt);
00639     das.<a class="code" href="classDAS.html#DASa9">print</a>(out);
00640     }
00641     fflush( stdout ) ;
00642 }
00643 
00644 <span class="keywordtype">void</span>
<a name="l00645"></a><a class="code" href="classDODSFilter.html#DODSFiltera25">00645</a> <a class="code" href="classDODSFilter.html#DODSFiltera25">DODSFilter::send_das</a>(<a class="code" href="classDAS.html">DAS</a> &amp;das, <span class="keyword">const</span> string &amp;anc_location)
00646 {
00647     <a class="code" href="classDODSFilter.html#DODSFiltera25">send_das</a>(stdout, das, anc_location);
00648 }
00649 
00664 <span class="keywordtype">void</span>
<a name="l00665"></a><a class="code" href="classDODSFilter.html#DODSFiltera29">00665</a> <a class="code" href="classDODSFilter.html#DODSFiltera28">DODSFilter::send_dds</a>(ostream &amp;os, <a class="code" href="classDDS.html">DDS</a> &amp;dds, <span class="keywordtype">bool</span> constrained,
00666              <span class="keyword">const</span> string &amp;anc_location)
00667 {
00668     <span class="comment">// If constrained, parse the constriant. Throws Error or InternalErr.</span>
00669     <span class="keywordflow">if</span> (constrained)
00670     dds.<a class="code" href="classDDS.html#DDSa36">parse_constraint</a>(<a class="code" href="classDODSFilter.html#DODSFilterp6">d_ce</a>, os, <span class="keyword">true</span>);
00671 
00672     time_t dds_lmt = <a class="code" href="classDODSFilter.html#DODSFiltera14">get_dds_last_modified_time</a>(anc_location);
00673     <span class="keywordflow">if</span> (<a class="code" href="classDODSFilter.html#DODSFiltera4">is_conditional</a>() 
00674     &amp;&amp; dds_lmt &lt;= <a class="code" href="classDODSFilter.html#DODSFiltera16">get_request_if_modified_since</a>()) {
00675     <a class="code" href="cgi__util_8cc.html#a22">set_mime_not_modified</a>(os);
00676     }
00677     <span class="keywordflow">else</span> {
00678     <a class="code" href="cgi__util_8cc.html#a16">set_mime_text</a>(os, <a class="code" href="ObjectType_8h.html#a6a2">dods_dds</a>, <a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a>, <a class="code" href="EncodingType_8h.html#a3a2">x_plain</a>, dds_lmt);
00679     <span class="keywordflow">if</span> (constrained)
00680         dds.<a class="code" href="classDDS.html#DDSa45">print_constrained</a>(os);
00681     <span class="keywordflow">else</span>
00682         dds.<a class="code" href="classDDS.html#DDSa43">print</a>(os);
00683     }
00684 }
00685 
00686 <span class="keywordtype">void</span>
<a name="l00687"></a><a class="code" href="classDODSFilter.html#DODSFiltera30">00687</a> <a class="code" href="classDODSFilter.html#DODSFiltera28">DODSFilter::send_dds</a>(FILE *out, <a class="code" href="classDDS.html">DDS</a> &amp;dds, <span class="keywordtype">bool</span> constrained,
00688              <span class="keyword">const</span> string &amp;anc_location)
00689 {
00690     <span class="comment">// If constrained, parse the constriant. Throws Error or InternalErr.</span>
00691     <span class="keywordflow">if</span> (constrained)
00692     dds.<a class="code" href="classDDS.html#DDSa36">parse_constraint</a>(<a class="code" href="classDODSFilter.html#DODSFilterp6">d_ce</a>, out, <span class="keyword">true</span>);
00693 
00694     time_t dds_lmt = <a class="code" href="classDODSFilter.html#DODSFiltera14">get_dds_last_modified_time</a>(anc_location);
00695     <span class="keywordflow">if</span> (<a class="code" href="classDODSFilter.html#DODSFiltera4">is_conditional</a>() 
00696     &amp;&amp; dds_lmt &lt;= <a class="code" href="classDODSFilter.html#DODSFiltera16">get_request_if_modified_since</a>()) {
00697     <a class="code" href="cgi__util_8cc.html#a22">set_mime_not_modified</a>(out);
00698     }
00699     <span class="keywordflow">else</span> {
00700     <a class="code" href="cgi__util_8cc.html#a16">set_mime_text</a>(out, <a class="code" href="ObjectType_8h.html#a6a2">dods_dds</a>, <a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a>, <a class="code" href="EncodingType_8h.html#a3a2">x_plain</a>, dds_lmt);
00701     <span class="keywordflow">if</span> (constrained)
00702         dds.<a class="code" href="classDDS.html#DDSa45">print_constrained</a>(out);
00703     <span class="keywordflow">else</span>
00704         dds.<a class="code" href="classDDS.html#DDSa43">print</a>(out);
00705     }
00706 
00707     fflush( stdout ) ;
00708 }
00709 
00710 <span class="keywordtype">void</span>
<a name="l00711"></a><a class="code" href="classDODSFilter.html#DODSFiltera28">00711</a> <a class="code" href="classDODSFilter.html#DODSFiltera28">DODSFilter::send_dds</a>(<a class="code" href="classDDS.html">DDS</a> &amp;dds, <span class="keywordtype">bool</span> constrained, <span class="keyword">const</span> string &amp;anc_location)
00712 {
00713     <a class="code" href="classDODSFilter.html#DODSFiltera28">send_dds</a>(stdout, dds, constrained, anc_location);
00714 }
00715 
00716 <span class="keywordtype">void</span>
<a name="l00717"></a><a class="code" href="classDODSFilter.html#DODSFiltera31">00717</a> <a class="code" href="classDODSFilter.html#DODSFiltera31">DODSFilter::functional_constraint</a>(<a class="code" href="classBaseType.html">BaseType</a> &amp;var, <a class="code" href="classDDS.html">DDS</a> &amp;dds, FILE *out,
00718                   time_t lmt) <span class="keywordflow">throw</span>(<a class="code" href="classError.html">Error</a>)
00719 {
00720     fprintf(out, <span class="stringliteral">"Dataset {\n"</span>);
00721     var.print_decl(out, <span class="stringliteral">"    "</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);
00722     fprintf(out, <span class="stringliteral">"} function_value;\n"</span>);
00723     fprintf(out, <span class="stringliteral">"Data:\n"</span>);
00724 
00725     fflush(out);
00726       
00727     <span class="comment">// Grab a stream encodes using XDR.</span>
00728     XDR *xdr_sink = <a class="code" href="util_8cc.html#a4">new_xdrstdio</a>(out, XDR_ENCODE);
00729 
00730     <span class="keywordflow">try</span> {
00731     <span class="comment">// In the following call to serialize, suppress CE evaluation.</span>
00732     var.serialize(d_dataset, dds, xdr_sink, <span class="keyword">false</span>);
00733     <a class="code" href="util_8cc.html#a6">delete_xdrstdio</a>(xdr_sink);
00734     }
00735     <span class="keywordflow">catch</span> (<a class="code" href="classError.html">Error</a> &amp;e) {
00736     <a class="code" href="util_8cc.html#a6">delete_xdrstdio</a>(xdr_sink);
00737     <span class="keywordflow">throw</span>;
00738     }
00739 }
00740 
00741 <span class="keywordtype">void</span>
<a name="l00742"></a><a class="code" href="classDODSFilter.html#DODSFiltera32">00742</a> <a class="code" href="classDODSFilter.html#DODSFiltera32">DODSFilter::dataset_constraint</a>(<a class="code" href="classDDS.html">DDS</a> &amp;dds, FILE *out, time_t lmt) <span class="keywordflow">throw</span>(<a class="code" href="classError.html">Error</a>)
00743 {
00744     <span class="comment">// send constrained DDS     </span>
00745     dds.print_constrained(out);
00746     fprintf(out, <span class="stringliteral">"Data:\n"</span>);
00747     fflush(out);
00748 
00749     <span class="comment">// Grab a stream that encodes using XDR.</span>
00750     XDR *xdr_sink = <a class="code" href="util_8cc.html#a4">new_xdrstdio</a>(out, XDR_ENCODE);
00751 
00752     <span class="keywordflow">try</span> {
00753     <span class="comment">// Send all variables in the current projection (send_p())</span>
00754     <span class="keywordflow">for</span> (<a class="code" href="classDDS.html#DDSw1">DDS::Vars_iter</a> i = dds.var_begin(); i != dds.var_end(); i++)
00755         <span class="keywordflow">if</span> ((*i)-&gt;send_p()) {
00756         <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"Sending "</span> &lt;&lt; (*i)-&gt;name() &lt;&lt; endl);
00757         (*i)-&gt;serialize(d_dataset, dds, xdr_sink, <span class="keyword">true</span>);
00758         }
00759 
00760     <a class="code" href="util_8cc.html#a6">delete_xdrstdio</a>(xdr_sink);
00761     }
00762     <span class="keywordflow">catch</span> (<a class="code" href="classError.html">Error</a> &amp;e) {
00763     <a class="code" href="util_8cc.html#a6">delete_xdrstdio</a>(xdr_sink);
00764     <span class="keywordflow">throw</span>;
00765     }
00766 }
00767 
00781 <span class="keywordtype">void</span>
<a name="l00782"></a><a class="code" href="classDODSFilter.html#DODSFiltera33">00782</a> <a class="code" href="classDODSFilter.html#DODSFiltera33">DODSFilter::send_data</a>(<a class="code" href="classDDS.html">DDS</a> &amp;dds, FILE *data_stream, <span class="keyword">const</span> string &amp;anc_location)
00783 {
00784     <span class="comment">// If this is a conditional request and the server should send a 304</span>
00785     <span class="comment">// response, do that and exit. Otherwise, continue on and send the full</span>
00786     <span class="comment">// response. </span>
00787     time_t data_lmt = <a class="code" href="classDODSFilter.html#DODSFiltera15">get_data_last_modified_time</a>(anc_location);
00788     <span class="keywordflow">if</span> (<a class="code" href="classDODSFilter.html#DODSFiltera4">is_conditional</a>()
00789     &amp;&amp; data_lmt &lt;= <a class="code" href="classDODSFilter.html#DODSFiltera16">get_request_if_modified_since</a>()) {
00790     <a class="code" href="cgi__util_8cc.html#a22">set_mime_not_modified</a>(data_stream);
00791     <span class="keywordflow">return</span>;
00792     }
00793 
00794     <span class="comment">// Set up the alarm.</span>
00795     <a class="code" href="classDODSFilter.html#DODSFiltera20">establish_timeout</a>(data_stream);
00796     dds.<a class="code" href="classDDS.html#DDSa20">set_timeout</a>(<a class="code" href="classDODSFilter.html#DODSFilterp11">d_timeout</a>);
00797 
00798     dds.<a class="code" href="classDDS.html#DDSa36">parse_constraint</a>(<a class="code" href="classDODSFilter.html#DODSFilterp6">d_ce</a>); <span class="comment">// Throws Error if the ce doesn't parse.</span>
00799 
00800     <span class="comment">// Start sending the response... </span>
00801     <span class="keywordtype">bool</span> compress = <a class="code" href="classDODSFilter.html#DODSFilterp0">d_comp</a> &amp;&amp; <a class="code" href="util_8cc.html#a9">deflate_exists</a>();
00802     <a class="code" href="cgi__util_8cc.html#a18">set_mime_binary</a>(data_stream, <a class="code" href="ObjectType_8h.html#a6a3">dods_data</a>, <a class="code" href="classDODSFilter.html#DODSFilterp7">d_cgi_ver</a>,
00803             (compress) ? <a class="code" href="EncodingType_8h.html#a3a1">deflate</a> : <a class="code" href="EncodingType_8h.html#a3a2">x_plain</a>, data_lmt);
00804     fflush(data_stream);
00805 
00806     <span class="keywordtype">int</span> childpid;
00807     <span class="keywordflow">if</span> (compress)
00808     data_stream = <a class="code" href="util_8cc.html#a10">compressor</a>(data_stream, childpid);
00809     <span class="comment">// Handle *functional* constraint expressions specially </span>
00810     <span class="keywordflow">if</span> (dds.<a class="code" href="classDDS.html#DDSa29">functional_expression</a>()) {
00811     <a class="code" href="classBaseType.html">BaseType</a> *var = dds.<a class="code" href="classDDS.html#DDSa32">eval_function</a>(<a class="code" href="classDODSFilter.html#DODSFilterp5">d_dataset</a>);
00812     <span class="keywordflow">if</span> (!var)
00813         <span class="keywordflow">throw</span> <a class="code" href="classError.html">Error</a>(<a class="code" href="Error_8h.html#a1">unknown_error</a>, <span class="stringliteral">"Error calling the CE function."</span>);
00814 
00815     <a class="code" href="classDODSFilter.html#DODSFiltera31">functional_constraint</a>(*var, dds, data_stream, data_lmt);
00816     }
00817     <span class="keywordflow">else</span>
00818     <a class="code" href="classDODSFilter.html#DODSFiltera32">dataset_constraint</a>(dds, data_stream, data_lmt);
00819     
00820     fclose(data_stream);
00821     <span class="keywordflow">if</span> (compress)
00822     <a class="code" href="DODSFilter_8cc.html#a0">WAITPID</a>(childpid);
00823 }
00824 
00825 <span class="comment">// $Log: DODSFilter_8cc-source.html,v $
00825 <span class="comment">// Revision 1.4  2004/02/05 06:51:16  jimg
00825 <span class="comment">// Added/update.
00825 <span class="comment">//</span>
00826 <span class="comment">// Revision 1.37.2.6  2003/09/06 22:29:00  jimg</span>
00827 <span class="comment">// Updated the documentation. Added instrumentation to DODSFilter::send().</span>
00828 <span class="comment">//</span>
00829 <span class="comment">// Revision 1.37.2.5  2003/08/17 01:37:54  rmorris</span>
00830 <span class="comment">// Removed "smart timeout" functionality under win32.  alarm() and</span>
00831 <span class="comment">// SIGALRM are not supported under win32 - plus that functionality</span>
00832 <span class="comment">// appears to be server-side only and win32 is client-side only.</span>
00833 <span class="comment">//</span>
00834 <span class="comment">// Revision 1.37.2.4  2003/07/25 06:04:28  jimg</span>
00835 <span class="comment">// Refactored the code so that DDS:send() is now incorporated into</span>
00836 <span class="comment">// DODSFilter::send_data(). The old DDS::send() is still there but is</span>
00837 <span class="comment">// depracated.</span>
00838 <span class="comment">// Added 'smart timeouts' to all the variable classes. This means that</span>
00839 <span class="comment">// the new server timeouts are active only for the data read and CE</span>
00840 <span class="comment">// evaluation. This went inthe BaseType::serialize() methods because it</span>
00841 <span class="comment">// needed to time both the read() calls and the dds::eval() calls.</span>
00842 <span class="comment">//</span>
00843 <span class="comment">// Revision 1.37.2.3  2003/07/23 23:56:36  jimg</span>
00844 <span class="comment">// Now supports a simple timeout system.</span>
00845 <span class="comment">//</span>
00846 <span class="comment">// Revision 1.37.2.2  2003/06/14 00:57:39  rmorris</span>
00847 <span class="comment">// Patched in a change lost during move to the 3-4 branch.</span>
00848 <span class="comment">//</span>
00849 <span class="comment">// Revision 1.37.2.1  2003/06/05 20:15:25  jimg</span>
00850 <span class="comment">// Removed many uses of strstream and replaced them with stringstream.</span>
00851 <span class="comment">//</span>
00852 <span class="comment">// Revision 1.37  2003/04/22 19:40:27  jimg</span>
00853 <span class="comment">// Merged with 3.3.1.</span>
00854 <span class="comment">//</span>
00855 <span class="comment">// Revision 1.30.2.4  2003/04/06 23:04:34  rmorris</span>
00856 <span class="comment">// Make the using:: statements for min, max #ifdef'd out for win32.</span>
00857 <span class="comment">//</span>
00858 <span class="comment">// Revision 1.36  2003/03/13 23:58:25  jimg</span>
00859 <span class="comment">// Hacked documentation. Added process_options() and initialize(). Changed the</span>
00860 <span class="comment">// names of the fields so that they all begin with 'd_'.</span>
00861 <span class="comment">//</span>
00862 <span class="comment">// Revision 1.30.2.3  2003/03/03 19:31:58  jimg</span>
00863 <span class="comment">// Added using std::min and std::max back to the code. They are needed for gcc</span>
00864 <span class="comment">// 3.2.1. and should be present for any ANSI C++ compiler; gcc 2 is laid back</span>
00865 <span class="comment">// about that stuff.</span>
00866 <span class="comment">//</span>
00867 <span class="comment">// Revision 1.35  2003/02/21 00:14:24  jimg</span>
00868 <span class="comment">// Repaired copyright.</span>
00869 <span class="comment">//</span>
00870 <span class="comment">// Revision 1.30.2.2  2003/02/21 00:10:07  jimg</span>
00871 <span class="comment">// Repaired copyright.</span>
00872 <span class="comment">//</span>
00873 <span class="comment">// Revision 1.30.2.1  2003/02/17 23:38:21  rmorris</span>
00874 <span class="comment">// Fix to compile under win32.  Problems with min/max def's under win32 and</span>
00875 <span class="comment">// UNIX.</span>
00876 <span class="comment">//</span>
00877 <span class="comment">// Revision 1.34  2003/02/09 12:18:31  rmorris</span>
00878 <span class="comment">// Fix to compile under win32.  Problem with min/max diffs under win32 and unix.</span>
00879 <span class="comment">//</span>
00880 <span class="comment">// Revision 1.30  2003/01/23 00:22:24  jimg</span>
00881 <span class="comment">// Updated the copyright notice; this implementation of the DAP is</span>
00882 <span class="comment">// copyrighted by OPeNDAP, Inc.</span>
00883 <span class="comment">//</span>
00884 <span class="comment">// Revision 1.29  2003/01/13 22:55:07  jimg</span>
00885 <span class="comment">// When a filter program got the -V option without a dataset, It was returning</span>
00886 <span class="comment">// usage information. Fixed.</span>
00887 <span class="comment">//</span>
00888 <span class="comment">// Revision 1.28  2003/01/10 19:46:40  jimg</span>
00889 <span class="comment">// Merged with code tagged release-3-2-10 on the release-3-2 branch. In many</span>
00890 <span class="comment">// cases files were added on that branch (so they appear on the trunk for</span>
00891 <span class="comment">// the first time).</span>
00892 <span class="comment">//</span>
00893 <span class="comment">// Revision 1.23.2.19  2002/12/20 00:46:58  jimg</span>
00894 <span class="comment">// I removed the include of sys/ddi.h. This header was not found on my</span>
00895 <span class="comment">// machine (Red Hat 7.3).</span>
00896 <span class="comment">//</span>
00897 <span class="comment">// Revision 1.23.2.18  2002/12/17 22:35:02  pwest</span>
00898 <span class="comment">// Added and updated methods using stdio. Deprecated methods using iostream.</span>
00899 <span class="comment">//</span>
00900 <span class="comment">// Revision 1.23.2.17  2002/12/01 14:37:52  rmorris</span>
00901 <span class="comment">// Smalling changes for the win32 porting and maintenance work.</span>
00902 <span class="comment">//</span>
00903 <span class="comment">// Revision 1.23.2.16  2002/11/21 21:24:17  pwest</span>
00904 <span class="comment">// memory leak cleanup and file descriptor cleanup</span>
00905 <span class="comment">//</span>
00906 <span class="comment">// Revision 1.23.2.15  2002/08/08 06:54:57  jimg</span>
00907 <span class="comment">// Changes for thread-safety. In many cases I found ugly places at the</span>
00908 <span class="comment">// tops of files while looking for globals, et c., and I fixed them up</span>
00909 <span class="comment">// (hopefully making them easier to read, ...). Only the files RCReader.cc</span>
00910 <span class="comment">// and usage.cc actually use pthreads synchronization functions. In other</span>
00911 <span class="comment">// cases I removed static objects where they were used for supposed</span>
00912 <span class="comment">// improvements in efficiency which had never actually been verifiied (and</span>
00913 <span class="comment">// which looked dubious).</span>
00914 <span class="comment">//</span>
00915 <span class="comment">// Revision 1.23.2.14  2002/06/18 22:50:06  jimg</span>
00916 <span class="comment">// Added include of util.h. This was necessary because I removed the include of</span>
00917 <span class="comment">// Connect.h from cgi_util.h.</span>
00918 <span class="comment">//</span>
00919 <span class="comment">// Revision 1.27  2002/06/18 15:36:24  tom</span>
00920 <span class="comment">// Moved comments and edited to accommodate doxygen documentation-generator.</span>
00921 <span class="comment">//</span>
00922 <span class="comment">// Revision 1.26  2002/06/03 22:21:15  jimg</span>
00923 <span class="comment">// Merged with release-3-2-9</span>
00924 <span class="comment">//</span>
00925 <span class="comment">// Revision 1.23.2.13  2002/03/29 18:40:20  jimg</span>
00926 <span class="comment">// Updated comments and/or removed dead code.</span>
00927 <span class="comment">//</span>
00928 <span class="comment">// Revision 1.23.2.12  2002/01/28 20:34:25  jimg</span>
00929 <span class="comment">// *** empty log message ***</span>
00930 <span class="comment">//</span>
00931 <span class="comment">// Revision 1.25  2001/08/24 17:46:22  jimg</span>
00932 <span class="comment">// Resolved conflicts from the merge of release 3.2.6</span>
00933 <span class="comment">//</span>
00934 <span class="comment">// Revision 1.23.2.11  2001/08/21 14:54:29  dan</span>
00935 <span class="comment">// Added a set_dataset_name method to provide a mechanism to change the</span>
00936 <span class="comment">// dataset name in the DODSFilter class, which currently can only be set</span>
00937 <span class="comment">// by running the constructor.   This method was required for a modification</span>
00938 <span class="comment">// to the jg-dods server which now support relative pathnames as part of</span>
00939 <span class="comment">// the object name.</span>
00940 <span class="comment">//</span>
00941 <span class="comment">// Revision 1.23.2.10  2001/08/18 00:18:41  jimg</span>
00942 <span class="comment">// Removed WIN32 compile guards from using statements.</span>
00943 <span class="comment">//</span>
00944 <span class="comment">// Revision 1.23.2.9  2001/07/28 01:04:46  jimg</span>
00945 <span class="comment">// Rewrote calls to www2id since it now uses strings and not Regexs.</span>
00946 <span class="comment">// Removed old code.</span>
00947 <span class="comment">//</span>
00948 <span class="comment">// Revision 1.24  2001/06/15 23:49:02  jimg</span>
00949 <span class="comment">// Merged with release-3-2-4.</span>
00950 <span class="comment">//</span>
00951 <span class="comment">// Revision 1.23.2.8  2001/06/14 21:31:15  jimg</span>
00952 <span class="comment">// Modified the handling of version requests as signaled by this class'</span>
00953 <span class="comment">// client. The version number printed from this class is for the core software.</span>
00954 <span class="comment">// The cgi_version property should be set by the client so that the</span>
00955 <span class="comment">// send_version() method will write both the core and server (CGI) version</span>
00956 <span class="comment">// numbers.</span>
00957 <span class="comment">//</span>
00958 <span class="comment">// Revision 1.23.2.7  2001/06/08 21:57:49  jimg</span>
00959 <span class="comment">// Really fixed the usage message this time...</span>
00960 <span class="comment">//</span>
00961 <span class="comment">// Revision 1.23.2.6  2001/06/08 21:37:02  jimg</span>
00962 <span class="comment">// Corrected the usage message. Added to text in the Error thrown as well.</span>
00963 <span class="comment">//</span>
00964 <span class="comment">// Revision 1.23.2.5  2001/05/16 21:12:26  jimg</span>
00965 <span class="comment">// Modified the ctor and set_ce() so that www2id() does not replace %20s</span>
00966 <span class="comment">// in either the dataset name or the CE. This keeps the parsers from gaging</span>
00967 <span class="comment">// on spaces (which they think are word separators).</span>
00968 <span class="comment">//</span>
00969 <span class="comment">// Revision 1.23.2.4  2001/05/07 17:19:08  jimg</span>
00970 <span class="comment">// The dataset name and CE are now passed through www2id() which removes WWW</span>
00971 <span class="comment">// escape sequences (those %&lt;hex digit&gt;&lt;hex digit&gt; things) and replaces them</span>
00972 <span class="comment">// with the correct ASCII characters. Fixed a bug where DAS::parse(FILE *)</span>
00973 <span class="comment">// and DDS::parse(FILE *) were often called with a null FILE *.</span>
00974 <span class="comment">//</span>
00975 <span class="comment">// Revision 1.23.2.3  2001/05/03 23:36:31  jimg</span>
00976 <span class="comment">// Removed all the catch clauses for Error and InternalErr. Code that uses</span>
00977 <span class="comment">// DODSFilter should catch (and probably serialize) Error and its children. All</span>
00978 <span class="comment">// of the current URI servers do this.</span>
00979 <span class="comment">//</span>
00980 <span class="comment">// Revision 1.23.2.2  2001/05/03 20:23:47  jimg</span>
00981 <span class="comment">// Added the methods is_conditional() and get_request_if_modified_since().</span>
00982 <span class="comment">// These are used to determine if the request was conditional and, if so, to</span>
00983 <span class="comment">// get the value of the If-Modified-Since header. Modified the send_das(),</span>
00984 <span class="comment">// send_dds() and send_data() methods so that a 304 (not modified) response</span>
00985 <span class="comment">// is sent if appropriate.</span>
00986 <span class="comment">//</span>
00987 <span class="comment">// Revision 1.23.2.1  2001/04/23 22:34:46  jimg</span>
00988 <span class="comment">// Added support for the Last-Modified MIME header in server responses.`</span>
00989 <span class="comment">//</span>
00990 <span class="comment">// Revision 1.23  2000/10/30 17:21:27  jimg</span>
00991 <span class="comment">// Added support for proxy servers (from cjm).</span>
00992 <span class="comment">//</span>
00993 <span class="comment">// Revision 1.22  2000/09/22 02:17:19  jimg</span>
00994 <span class="comment">// Rearranged source files so that the CVS logs appear at the end rather than</span>
00995 <span class="comment">// the start. Also made the ifdef guard symbols use the same naming scheme and</span>
00996 <span class="comment">// wrapped headers included in other headers in those guard symbols (to cut</span>
00997 <span class="comment">// down on extraneous file processing - See Lakos).</span>
00998 <span class="comment">//</span>
00999 <span class="comment">// Revision 1.21  2000/09/21 16:22:07  jimg</span>
01000 <span class="comment">// Merged changes from Jose Garcia that add exceptions to the software.</span>
01001 <span class="comment">// Many methods that returned error codes now throw exectptions. There are</span>
01002 <span class="comment">// two classes which are thrown by the software, Error and InternalErr.</span>
01003 <span class="comment">// InternalErr is used to report errors within the library or errors using</span>
01004 <span class="comment">// the library. Error is used to reprot all other errors. Since InternalErr</span>
01005 <span class="comment">// is a subclass of Error, programs need only to catch Error.</span>
01006 <span class="comment">//</span>
01007 <span class="comment">// Revision 1.20  2000/07/09 22:05:35  rmorris</span>
01008 <span class="comment">// Changes to increase portability, minimize ifdef's for win32 and account</span>
01009 <span class="comment">// for differences in the iostreams implementations.</span>
01010 <span class="comment">//</span>
01011 <span class="comment">// Revision 1.19  2000/06/07 19:33:21  jimg</span>
01012 <span class="comment">// Merged with verson 3.1.6</span>
01013 <span class="comment">//</span>
01014 <span class="comment">// Revision 1.18  2000/06/07 18:06:58  jimg</span>
01015 <span class="comment">// Merged the pc port branch</span>
01016 <span class="comment">//</span>
01017 <span class="comment">// Revision 1.17.10.1  2000/06/02 18:16:48  rmorris</span>
01018 <span class="comment">// Mod's for port to Win32.</span>
01019 <span class="comment">//</span>
01020 <span class="comment">// Revision 1.16.2.3  2000/05/18 20:45:27  jimg</span>
01021 <span class="comment">// added set_ce(). Maybe add more set methods?</span>
01022 <span class="comment">//</span>
01023 <span class="comment">// Revision 1.17.4.3  2000/03/08 00:09:04  jgarcia</span>
01024 <span class="comment">// replace ostrstream with string;added functions to convert from double and</span>
01025 <span class="comment">// long to string</span>
01026 <span class="comment">//</span>
01027 <span class="comment">// Revision 1.17.4.2  2000/02/17 05:03:12  jimg</span>
01028 <span class="comment">// Added file and line number information to calls to InternalErr.</span>
01029 <span class="comment">// Resolved compile-time problems with read due to a change in its</span>
01030 <span class="comment">// parameter list given that errors are now reported using exceptions.</span>
01031 <span class="comment">//</span>
01032 <span class="comment">// Revision 1.17.4.1  2000/02/07 21:11:36  jgarcia</span>
01033 <span class="comment">// modified prototypes and implementations to use exceeption handling</span>
01034 <span class="comment">//</span>
01035 <span class="comment">// Revision 1.16.2.2  1999/09/08 22:36:51  jimg</span>
01036 <span class="comment">// Fixed the spelling of version (was vision) and the usage line (did not</span>
01037 <span class="comment">// include -V).</span>
01038 <span class="comment">//</span>
01039 <span class="comment">// Revision 1.17  1999/09/03 22:07:44  jimg</span>
01040 <span class="comment">// Merged changes from release-3-1-1</span>
01041 <span class="comment">//</span>
01042 <span class="comment">// Revision 1.16.2.1  1999/08/28 06:43:04  jimg</span>
01043 <span class="comment">// Fixed the implementation/interface pragmas and misc comments</span>
01044 <span class="comment">//</span>
01045 <span class="comment">// Revision 1.16  1999/07/22 17:11:51  jimg</span>
01046 <span class="comment">// Merged changes from the release-3-0-2 branch</span>
01047 <span class="comment">//</span>
01048 <span class="comment">// Revision 1.15.4.1  1999/06/01 15:43:51  jimg</span>
01049 <span class="comment">// Made dods/3.0 the default version number. This makes is simpler to debug</span>
01050 <span class="comment">// dods servers since running the server filter programs will generate valid</span>
01051 <span class="comment">// headers now. Before you had to remember to use the -v option and give a</span>
01052 <span class="comment">// version string/number or the MIME header would not be valid. This confused</span>
01053 <span class="comment">// the MIME header parse which hosed the data stream.</span>
01054 <span class="comment">//</span>
01055 <span class="comment">// Revision 1.15  1999/05/26 17:37:02  jimg</span>
01056 <span class="comment">// Added a bit where, before sending caught Error objects to the client, we</span>
01057 <span class="comment">// write the message to t eh httpd's error_log.</span>
01058 <span class="comment">//</span>
01059 <span class="comment">// Revision 1.14  1999/05/25 21:57:52  dan</span>
01060 <span class="comment">// Added an optional second argument to read_ancillary_dds to support</span>
01061 <span class="comment">// JGOFS usage.</span>
01062 <span class="comment">//</span>
01063 <span class="comment">// Revision 1.13  1999/05/25 21:54:19  dan</span>
01064 <span class="comment">// Added an optional argument to read_ancillary_das to support JGOFS</span>
01065 <span class="comment">// data object usage, where the location of the ancillary DAS file isn't</span>
01066 <span class="comment">// readily available through the 'dataset' argument of the command line.</span>
01067 <span class="comment">//</span>
01068 <span class="comment">// Revision 1.12  1999/05/21 17:15:46  jimg</span>
01069 <span class="comment">// Added instrumentation to the ctor. This simplifies debugging the interaction</span>
01070 <span class="comment">// between the filter programs and the perl script.</span>
01071 <span class="comment">//</span>
01072 <span class="comment">// Revision 1.11  1999/05/19 23:56:57  jimg</span>
01073 <span class="comment">// Changed the support address from @dods to @unidata</span>
01074 <span class="comment">//</span>
01075 <span class="comment">// Revision 1.10  1999/05/05 00:36:36  jimg</span>
01076 <span class="comment">// Added the -V option. -v now is used to pass the version information from</span>
01077 <span class="comment">// the CGI to the C++ software; -V triggers output of the version message.</span>
01078 <span class="comment">// This allows the DODSFilter class to pass information about the server's</span>
01079 <span class="comment">// version to the core software. All set_mime_*() functions are now passes</span>
01080 <span class="comment">// the CGI version information so that all MIME headers contain information</span>
01081 <span class="comment">// about the server's version. Added the get_cgi_version() member function so</span>
01082 <span class="comment">// that clients of DODSFilter can find out the version number.</span>
01083 <span class="comment">//</span>
01084 <span class="comment">// Revision 1.9  1999/05/04 19:47:21  jimg</span>
01085 <span class="comment">// Fixed copyright statements. Removed more of the GNU classes.</span>
01086 <span class="comment">//</span>
01087 <span class="comment">// Revision 1.8  1999/04/29 02:29:28  jimg</span>
01088 <span class="comment">// Merge of no-gnu branch</span>
01089 <span class="comment">//</span>
01090 <span class="comment">// Revision 1.7  1999/02/22 22:59:07  jimg</span>
01091 <span class="comment">// Added the get_accept_types() accessor.</span>
01092 <span class="comment">// Changed the ctor so that the -t option is recognized.</span>
01093 <span class="comment">//</span>
01094 <span class="comment">// Revision 1.6  1998/12/16 19:10:53  jimg</span>
01095 <span class="comment">// Added support for XDODS-Server MIME header. This fixes a problem where our</span>
01096 <span class="comment">// use of Server clashed with Java.</span>
01097 <span class="comment">//</span>
01098 <span class="comment">// Revision 1.5  1998/11/10 01:04:42  jimg</span>
01099 <span class="comment">// Added `ends' to strings made with ostrstream (fixes a bug found with</span>
01100 <span class="comment">// purify).</span>
01101 <span class="comment">// Added catch for throws from within the CE evaluation functions.</span>
01102 <span class="comment">//</span>
01103 <span class="comment">// Revision 1.4.2.2  1999/02/05 09:32:34  jimg</span>
01104 <span class="comment">// Fixed __unused__ so that it not longer clashes with Red Hat 5.2 inlined</span>
01105 <span class="comment">// math code. </span>
01106 <span class="comment">//</span>
01107 <span class="comment">// Revision 1.4.2.1  1999/02/02 21:56:57  jimg</span>
01108 <span class="comment">// String to string version</span>
01109 <span class="comment">//</span>
01110 <span class="comment">// Revision 1.4  1998/08/06 16:12:30  jimg</span>
01111 <span class="comment">// Added cache dir methods and stuff to ctor (from jeh)</span>
01112 <span class="comment">//</span>
01113 <span class="comment">// Revision 1.3  1998/03/19 23:34:21  jimg</span>
01114 <span class="comment">// Fixed calls to set_mime_*().</span>
01115 <span class="comment">// Removed the compression code (it is now in DDS::send().</span>
01116 <span class="comment">// Removed old code (that was surrounded by #if 0 ... #endif).</span>
01117 <span class="comment">//</span>
01118 <span class="comment">// Revision 1.2  1998/02/11 22:00:46  jimg</span>
01119 <span class="comment">// Added call to util.cc:deflate_exists() to send_data(). This means that</span>
01120 <span class="comment">// send_data() will only try to start the compressor if an executable copy of</span>
01121 <span class="comment">// deflate can be found. If, for any reason a copy of deflate cannot be found</span>
01122 <span class="comment">// data is sent without trying to compress it.</span>
01123 <span class="comment">//</span>
01124 <span class="comment">// Revision 1.1  1997/08/28 20:39:02  jimg</span>
01125 <span class="comment">// Created</span>
01126 <span class="comment">//</span>
01127 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Feb 4 23:42:59 2004 for libdap++ by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
