<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libdap++: GSEClause.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>GSEClause.h</h1><a href="GSEClause_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 <span class="comment">// -*- mode: c++; c-basic-offset:4 -*-</span>
00003 
00004 <span class="comment">// This file is part of libdap, A C++ implementation of the OPeNDAP Data</span>
00005 <span class="comment">// Access Protocol.</span>
00006 
00007 <span class="comment">// Copyright (c) 2002,2003 OPeNDAP, Inc.</span>
00008 <span class="comment">// Author: James Gallagher &lt;jgallagher@opendap.org&gt;</span>
00009 <span class="comment">//</span>
00010 <span class="comment">// This library is free software; you can redistribute it and/or</span>
00011 <span class="comment">// modify it under the terms of the GNU Lesser General Public</span>
00012 <span class="comment">// License as published by the Free Software Foundation; either</span>
00013 <span class="comment">// version 2.1 of the License, or (at your option) any later version.</span>
00014 <span class="comment">// </span>
00015 <span class="comment">// This library is distributed in the hope that it will be useful,</span>
00016 <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00017 <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
00018 <span class="comment">// Lesser General Public License for more details.</span>
00019 <span class="comment">// </span>
00020 <span class="comment">// You should have received a copy of the GNU Lesser General Public</span>
00021 <span class="comment">// License along with this library; if not, write to the Free Software</span>
00022 <span class="comment">// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00023 <span class="comment">//</span>
00024 <span class="comment">// You can contact OPeNDAP, Inc. at PO Box 112, Saunderstown, RI. 02874-0112.</span>
00025  
00026 <span class="comment">// (c) COPYRIGHT URI/MIT 1999</span>
00027 <span class="comment">// Please read the full copyright statement in the file COPYRIGHT_URI.</span>
00028 <span class="comment">//</span>
00029 <span class="comment">// Authors:</span>
00030 <span class="comment">//      jhrg,jimg       James Gallagher &lt;jgallagher@gso.uri.edu&gt;</span>
00031 
00032 <span class="comment">// The Grid Selection Expression Clause class.</span>
00033 
00034 <span class="preprocessor">#ifndef _gseclause_h</span>
<a name="l00035"></a><a class="code" href="GSEClause_8h.html#a0">00035</a> <span class="preprocessor"></span><span class="preprocessor">#define _gseclause_h 1</span>
00036 <span class="preprocessor"></span>
00037 <span class="preprocessor">#ifdef _GNUG_</span>
00038 <span class="preprocessor"></span><span class="preprocessor">#pragma interface</span>
00039 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00040 <span class="preprocessor"></span>
00041 <span class="preprocessor">#include &lt;string&gt;</span>
00042 <span class="preprocessor">#include &lt;sstream&gt;</span>
00043 
00044 <span class="preprocessor">#ifndef _basetype_h</span>
00045 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="BaseType_8h.html">BaseType.h</a>"</span>
00046 <span class="preprocessor">#endif</span>
00047 <span class="preprocessor"></span>
00048 <span class="preprocessor">#ifndef _array_h</span>
00049 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="Array_8h.html">Array.h</a>"</span>
00050 <span class="preprocessor">#endif</span>
00051 <span class="preprocessor"></span>
00052 <span class="preprocessor">#ifndef _grid_h</span>
00053 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="Grid_8h.html">Grid.h</a>"</span>
00054 <span class="preprocessor">#endif</span>
00055 <span class="preprocessor"></span>
<a name="l00056"></a><a class="code" href="GSEClause_8h.html#a8">00056</a> <span class="keyword">enum</span> <a class="code" href="GSEClause_8h.html#a8">relop</a> {
00057     <a class="code" href="GSEClause_8h.html#a8a1">dods_nop_op</a>,
00058     <a class="code" href="GSEClause_8h.html#a8a2">dods_greater_op</a>,
00059     <a class="code" href="GSEClause_8h.html#a8a3">dods_greater_equal_op</a>,
00060     <a class="code" href="GSEClause_8h.html#a8a4">dods_less_op</a>,
00061     <a class="code" href="GSEClause_8h.html#a8a5">dods_less_equal_op</a>,
00062     <a class="code" href="GSEClause_8h.html#a8a6">dods_equal_op</a>,
00063     <a class="code" href="GSEClause_8h.html#a8a7">dods_not_equal_op</a>
00064 };
00065 
<a name="l00074"></a><a class="code" href="classGSEClause.html">00074</a> <span class="keyword">class </span><a class="code" href="classGSEClause.html">GSEClause</a> {
00075 <span class="keyword">private</span>:
00076     <a class="code" href="classArray.html">Array</a> *d_map;
00077     <span class="comment">// _value1, 2 and _op1, 2 hold the first and second operators and</span>
00078     <span class="comment">// operands. For a clause like `var op value' only _op1 and _value1 have</span>
00079     <span class="comment">// valid information. For a clause like `value op var op value' the</span>
00080     <span class="comment">// second operator and operand are on _op2 and _value2. 1/19/99 jhrg</span>
00081     <span class="keywordtype">double</span> d_value1, d_value2;
00082     <a class="code" href="GSEClause_8h.html#a8">relop</a> d_op1, d_op2;
00083     <span class="keywordtype">int</span> d_start;
00084     <span class="keywordtype">int</span> d_stop;
00085 
00086     string d_map_min_value, d_map_max_value;
00087 
00088     <a class="code" href="classGSEClause.html#GSEClausez76_0">GSEClause</a>();        <span class="comment">// Hidden default constructor.</span>
00089 
00090     <a class="code" href="classGSEClause.html#GSEClausez76_0">GSEClause</a>(<span class="keyword">const</span> <a class="code" href="classGSEClause.html">GSEClause</a> &amp;param); <span class="comment">// Hide</span>
00091     <a class="code" href="classGSEClause.html">GSEClause</a> &amp;operator=(<a class="code" href="classGSEClause.html">GSEClause</a> &amp;rhs); <span class="comment">// Hide</span>
00092 
00093 <span class="preprocessor">#ifdef WIN32</span>
00094 <span class="preprocessor"></span>    <span class="comment">//  MS Visual C++ 6.0 forces us to declare template member functions</span>
00095     <span class="comment">//  this way and forces us to inline them due to short-comings in their</span>
00096     <span class="comment">//  implementation.  In addition, the use of the arg is a bug work-around</span>
00097     <span class="comment">//  that lets it be known what the type of T is.  There exists an non-</span>
00098     <span class="comment">//  inline version of this function also - if you edit one, you should</span>
00099     <span class="comment">//  probably edit the other also.</span>
00100     <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; 
00101     T 
00102     set_start_stop(T *t=0) {
00103     <span class="comment">// Read the byte array, scan, set start and stop.</span>
00104     T *vals = 0;
00105     d_map-&gt;<a class="code" href="classVector.html#Vectora14">buf2val</a>((<span class="keywordtype">void</span> **)&amp;vals);
00106 
00107     <span class="comment">// Set the map's max and min values for use in error messages (it's a</span>
00108     <span class="comment">// lot easier to do here, now, than later... 9/20/2001 jhrg)</span>
00109     set_map_min_max_value(vals[d_start], vals[d_stop]);
00110 
00111     <span class="keywordtype">int</span> i = d_start;
00112     <span class="keywordtype">int</span> end = d_stop;
00113     <span class="keywordflow">while</span>(i &lt;= end &amp;&amp; !compare&lt;T&gt;(vals[i], d_op1, d_value1))
00114         i++;
00115 
00116     d_start = i;
00117 
00118     i = end;
00119     <span class="keywordflow">while</span>(i &gt;= 0 &amp;&amp; !compare&lt;T&gt;(vals[i], d_op1, d_value1))
00120         i--;
00121 
00122     d_stop = i;
00123 
00124     <span class="comment">// Every clause must have one operator but the second is optional</span>
00125     <span class="comment">// since the more complex for of a clause is optional.</span>
00126     <span class="keywordflow">if</span> (d_op2 != <a class="code" href="GSEClause_8h.html#a8a1">dods_nop_op</a>) {
00127         <span class="keywordtype">int</span> i = d_start;
00128         <span class="keywordtype">int</span> end = d_stop;
00129         <span class="keywordflow">while</span>(i &lt;= end &amp;&amp; !compare&lt;T&gt;(vals[i], d_op2, d_value2))
00130         i++;
00131 
00132         d_start = i;
00133 
00134         i = end;
00135         <span class="keywordflow">while</span>(i &gt;= 0 &amp;&amp; !compare&lt;T&gt;(vals[i], d_op2, d_value2))
00136         i--;
00137 
00138         d_stop = i;
00139     }
00140 
00141     <span class="keywordflow">return</span> 0;
00142     }
00143 
00144     <span class="comment">//  See above comment regarding win32.  That also applies here</span>
00145     <span class="comment">//  except that we don't have to force in a dummy arg because</span>
00146     <span class="comment">//  we already use parameterized types in the args for this method.</span>
00147     <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;
00148     T
00149     set_map_min_max_value(T min, T max) {
00150     <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"Inside set map min max value "</span> &lt;&lt; min &lt;&lt; <span class="stringliteral">", "</span> &lt;&lt; max 
00151         &lt;&lt; endl);
00152 
00153     std::stringstream oss1;
00154     oss1 &lt;&lt; min;
00155     d_map_min_value = oss1.str();
00156 
00157     std::stringstream oss2;
00158     oss2 &lt;&lt; max;
00159     d_map_max_value = oss2.str();
00160 
00161     <span class="keywordflow">return</span> 0;
00162     }
00163 
00164 <span class="preprocessor">#else</span>
00165 <span class="preprocessor"></span>    <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> set_start_stop();
00166     <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">void</span> set_map_min_max_value(T min, T max);
00167 <span class="preprocessor">#endif // WIN32</span>
00168 <span class="preprocessor"></span>
00169     <span class="keywordtype">void</span> compute_indices();
00170 
00171 <span class="keyword">public</span>:
00174   <a class="code" href="classGSEClause.html#GSEClausez76_0">GSEClause</a>(<a class="code" href="classGrid.html">Grid</a> *grid, <span class="keyword">const</span> string &amp;map, <span class="keyword">const</span> <span class="keywordtype">double</span> value,
00175         <span class="keyword">const</span> <a class="code" href="GSEClause_8h.html#a8">relop</a> op);
00176 
00177   <a class="code" href="classGSEClause.html#GSEClausez76_0">GSEClause</a>(<a class="code" href="classGrid.html">Grid</a> *grid, <span class="keyword">const</span> string &amp;map, <span class="keyword">const</span> <span class="keywordtype">double</span> value1,
00178         <span class="keyword">const</span> <a class="code" href="GSEClause_8h.html#a8">relop</a> op1, <span class="keyword">const</span> <span class="keywordtype">double</span> value2, <span class="keyword">const</span> <a class="code" href="GSEClause_8h.html#a8">relop</a> op2);
00179 
00180   <a class="code" href="classGSEClause.html#GSEClausez76_0">GSEClause</a>(<a class="code" href="classGrid.html">Grid</a> *grid, <span class="keyword">const</span> string &amp;expr);
00181 
00182   <a class="code" href="classGSEClause.html#GSEClausez76_0">GSEClause</a>(<a class="code" href="classGrid.html">Grid</a> *grid, <span class="keywordtype">char</span> *expr);
00184     
00185   <span class="keywordtype">bool</span> <a class="code" href="classGSEClause.html#GSEClausea0">OK</a>() <span class="keyword">const</span>;
00186 
00189   <a class="code" href="classArray.html">Array</a> *<a class="code" href="classGSEClause.html#GSEClausez78_0">get_map</a>() <span class="keyword">const</span>;
00190 
00191   string <a class="code" href="classGSEClause.html#GSEClausez78_1">get_map_name</a>() <span class="keyword">const</span>;
00192 
00193   <span class="keywordtype">int</span> <a class="code" href="classGSEClause.html#GSEClausez78_2">get_start</a>() <span class="keyword">const</span>;
00194 
00195   <span class="keywordtype">int</span> <a class="code" href="classGSEClause.html#GSEClausez78_3">get_stop</a>() <span class="keyword">const</span>;
00196 
00197   string <a class="code" href="classGSEClause.html#GSEClausez78_4">get_map_min_value</a>() <span class="keyword">const</span>;
00198 
00199   string <a class="code" href="classGSEClause.html#GSEClausez78_5">get_map_max_value</a>() <span class="keyword">const</span>;
00201 
00204   <span class="keywordtype">void</span> <a class="code" href="classGSEClause.html#GSEClausez80_0">set_map</a>(<a class="code" href="classArray.html">Array</a> *map);
00205 
00206   <span class="keywordtype">void</span> <a class="code" href="classGSEClause.html#GSEClausez80_1">set_start</a>(<span class="keywordtype">int</span> start);
00207 
00208   <span class="keywordtype">void</span> <a class="code" href="classGSEClause.html#GSEClausez80_2">set_stop</a>(<span class="keywordtype">int</span> stop);
00210 };
00211 
00212 <span class="comment">// $Log: GSEClause_8h-source.html,v $
00212 <span class="comment">// Revision 1.4  2004/02/05 06:51:16  jimg
00212 <span class="comment">// Added/update.
00212 <span class="comment">//</span>
00213 <span class="comment">// Revision 1.11.2.2  2003/09/06 22:32:35  jimg</span>
00214 <span class="comment">// Now uses stringstream instead of strstream.</span>
00215 <span class="comment">//</span>
00216 <span class="comment">// Revision 1.11.2.1  2003/06/14 00:54:30  rmorris</span>
00217 <span class="comment">// Added a header VC++ was looking for - &lt;strstream&gt;.</span>
00218 <span class="comment">//</span>
00219 <span class="comment">// Revision 1.11  2003/04/22 19:40:27  jimg</span>
00220 <span class="comment">// Merged with 3.3.1.</span>
00221 <span class="comment">//</span>
00222 <span class="comment">// Revision 1.10  2003/02/21 00:14:24  jimg</span>
00223 <span class="comment">// Repaired copyright.</span>
00224 <span class="comment">//</span>
00225 <span class="comment">// Revision 1.9.2.1  2003/02/21 00:10:07  jimg</span>
00226 <span class="comment">// Repaired copyright.</span>
00227 <span class="comment">//</span>
00228 <span class="comment">// Revision 1.9  2003/01/23 00:22:24  jimg</span>
00229 <span class="comment">// Updated the copyright notice; this implementation of the DAP is</span>
00230 <span class="comment">// copyrighted by OPeNDAP, Inc.</span>
00231 <span class="comment">//</span>
00232 <span class="comment">// Revision 1.8  2002/06/18 15:36:24  tom</span>
00233 <span class="comment">// Moved comments and edited to accommodate doxygen documentation-generator.</span>
00234 <span class="comment">//</span>
00235 <span class="comment">// Revision 1.7  2002/06/03 22:21:15  jimg</span>
00236 <span class="comment">// Merged with release-3-2-9</span>
00237 <span class="comment">//</span>
00238 <span class="comment">// Revision 1.5.4.2  2001/10/30 06:55:45  rmorris</span>
00239 <span class="comment">// Win32 porting changes.  Brings core win32 port up-to-date.</span>
00240 <span class="comment">//</span>
00241 <span class="comment">// Revision 1.6  2001/09/28 17:50:07  jimg</span>
00242 <span class="comment">// Merged with 3.2.7.</span>
00243 <span class="comment">//</span>
00244 <span class="comment">// Revision 1.5.4.1  2001/09/25 20:32:16  jimg</span>
00245 <span class="comment">// Changes/Fixes associated with fixing grid() (see ce_functions.cc).</span>
00246 <span class="comment">//</span>
00247 <span class="comment">// Revision 1.5  2000/09/22 02:17:20  jimg</span>
00248 <span class="comment">// Rearranged source files so that the CVS logs appear at the end rather than</span>
00249 <span class="comment">// the start. Also made the ifdef guard symbols use the same naming scheme and</span>
00250 <span class="comment">// wrapped headers included in other headers in those guard symbols (to cut</span>
00251 <span class="comment">// down on extraneous file processing - See Lakos).</span>
00252 <span class="comment">//</span>
00253 <span class="comment">// Revision 1.4  2000/06/07 18:06:59  jimg</span>
00254 <span class="comment">// Merged the pc port branch</span>
00255 <span class="comment">//</span>
00256 <span class="comment">// Revision 1.3.20.1  2000/06/02 18:21:27  rmorris</span>
00257 <span class="comment">// Mod's for port to Win32.</span>
00258 <span class="comment">//</span>
00259 <span class="comment">// Revision 1.3  1999/04/29 02:29:30  jimg</span>
00260 <span class="comment">// Merge of no-gnu branch</span>
00261 <span class="comment">//</span>
00262 <span class="comment">// Revision 1.2  1999/03/24 23:37:15  jimg</span>
00263 <span class="comment">// Added support for the Int16, UInt16 and Float32 types</span>
00264 <span class="comment">//</span>
00265 <span class="comment">// Revision 1.1  1999/01/21 02:07:44  jimg</span>
00266 <span class="comment">// Created</span>
00267 <span class="comment">//</span>
00268 
00269 <span class="preprocessor">#endif // _gseclause_h</span>
00270 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Feb 4 23:43:01 2004 for libdap++ by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
