<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libdap++: geturl.cc Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>geturl.cc</h1><a href="geturl_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00002 <span class="comment">// -*- mode: c++; c-basic-offset:4 -*-</span>
00003 
00004 <span class="comment">// This file is part of libdap, A C++ implementation of the OPeNDAP Data</span>
00005 <span class="comment">// Access Protocol.</span>
00006 
00007 <span class="comment">// Copyright (c) 2002,2003 OPeNDAP, Inc.</span>
00008 <span class="comment">// Author: James Gallagher &lt;jgallagher@opendap.org&gt;</span>
00009 <span class="comment">//</span>
00010 <span class="comment">// This library is free software; you can redistribute it and/or</span>
00011 <span class="comment">// modify it under the terms of the GNU Lesser General Public</span>
00012 <span class="comment">// License as published by the Free Software Foundation; either</span>
00013 <span class="comment">// version 2.1 of the License, or (at your option) any later version.</span>
00014 <span class="comment">// </span>
00015 <span class="comment">// This library is distributed in the hope that it will be useful,</span>
00016 <span class="comment">// but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00017 <span class="comment">// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
00018 <span class="comment">// Lesser General Public License for more details.</span>
00019 <span class="comment">// </span>
00020 <span class="comment">// You should have received a copy of the GNU Lesser General Public</span>
00021 <span class="comment">// License along with this library; if not, write to the Free Software</span>
00022 <span class="comment">// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00023 <span class="comment">//</span>
00024 <span class="comment">// You can contact OPeNDAP, Inc. at PO Box 112, Saunderstown, RI. 02874-0112.</span>
00025  
00026 <span class="comment">// (c) COPYRIGHT URI/MIT 1997-1999</span>
00027 <span class="comment">// Please read the full copyright statement in the file COPYRIGHT_URI.</span>
00028 <span class="comment">//</span>
00029 <span class="comment">// Authors:</span>
00030 <span class="comment">//  jhrg,jimg   James Gallagher &lt;jgallagher@gso.uri.edu&gt;</span>
00031 
00032 <span class="comment">// This is the source to `geturl'; a simple tool to exercise the Connect</span>
00033 <span class="comment">// class. It can be used to get naked URLs as well as the DODS DAS and DDS</span>
00034 <span class="comment">// objects.  jhrg.</span>
00035 
00036 <span class="preprocessor">#include "<a class="code" href="config__dap_8h.html">config_dap.h</a>"</span>
00037 
00038 <span class="keyword">static</span> <span class="keywordtype">char</span> rcsid[] <a class="code" href="config__dap_8h.html#a49">not_used</a> = {<span class="stringliteral">"$Id$"</span>};
00039 
00040 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
00041 <span class="preprocessor">#ifdef WIN32</span>
00042 <span class="preprocessor"></span><span class="preprocessor">#include &lt;io.h&gt;</span>
00043 <span class="preprocessor">#include &lt;fcntl.h&gt;</span>
00044 <span class="preprocessor">#endif</span>
00045 <span class="preprocessor"></span>
00046 <span class="preprocessor">#include &lt;GetOpt.h&gt;</span>
00047 <span class="preprocessor">#include &lt;string&gt;</span>
00048 
00049 <span class="preprocessor">#include "<a class="code" href="AISConnect_8h.html">AISConnect.h</a>"</span>
00050 
00051 <span class="keyword">using</span> std::cerr;
00052 <span class="keyword">using</span> std::endl;
00053 
<a name="l00054"></a><a class="code" href="geturl_8cc.html#a1">00054</a> <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="das-test_8cc.html#a4">version</a> = <span class="stringliteral">"$Revision$"</span>;
00055 
<a name="l00056"></a><a class="code" href="geturl_8cc.html#a2">00056</a> <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="geturl_8cc.html#a2">dods_keep_temps</a>; <span class="comment">// defined in HTTPResponse.h</span>
00057 
00058 <span class="keywordtype">void</span>
<a name="l00059"></a><a class="code" href="geturl_8cc.html#a3">00059</a> <a class="code" href="error-test_8cc.html#a6">usage</a>(string name)
00060 {
00061     cerr &lt;&lt; <span class="stringliteral">"Usage: "</span> &lt;&lt; name &lt;&lt; endl;
00062     cerr &lt;&lt; <span class="stringliteral">" [idDaAVvk] [-B &lt;db&gt;][-c &lt;expr&gt;][-m &lt;num&gt;] &lt;url&gt; [&lt;url&gt; ...]"</span> 
00063      &lt;&lt; endl;
00064     cerr &lt;&lt; <span class="stringliteral">" [Vvk] &lt;file&gt; [&lt;file&gt; ...]"</span> &lt;&lt; endl;
00065     cerr &lt;&lt; endl;
00066     cerr &lt;&lt; <span class="stringliteral">"In the first form of the command, dereference the URL and"</span> 
00067      &lt;&lt; endl;
00068     cerr &lt;&lt; <span class="stringliteral">"perform the requested operations. This include routing"</span> &lt;&lt; endl;
00069     cerr &lt;&lt; <span class="stringliteral">"the returned information through the DAP processing"</span> &lt;&lt; endl;
00070     cerr &lt;&lt; <span class="stringliteral">"library (parsing the returned objects, et c.). If none"</span> &lt;&lt; endl;
00071     cerr &lt;&lt; <span class="stringliteral">"of a, d, or D are used with a URL, then the DAP library"</span> &lt;&lt; endl;
00072     cerr &lt;&lt; <span class="stringliteral">"routines are NOT used and the URLs contents are dumped"</span> &lt;&lt; endl;
00073     cerr &lt;&lt; <span class="stringliteral">"to standard output."</span> &lt;&lt; endl;
00074     cerr &lt;&lt; endl;
00075     cerr &lt;&lt; <span class="stringliteral">"In the second form of the command, assume the files are"</span> &lt;&lt; endl;
00076     cerr &lt;&lt; <span class="stringliteral">"DODS data objects (stored in files or read from pipes)"</span> &lt;&lt; endl;
00077     cerr &lt;&lt; <span class="stringliteral">"and process them as if -D were given. In this case the"</span> &lt;&lt; endl;
00078     cerr &lt;&lt; <span class="stringliteral">"information *must* contain valid MIME header in order"</span> &lt;&lt; endl;
00079     cerr &lt;&lt; <span class="stringliteral">"to be processed."</span> &lt;&lt; endl;
00080     cerr &lt;&lt; endl;
00081     cerr &lt;&lt; <span class="stringliteral">"Options:"</span> &lt;&lt; endl;
00082     cerr &lt;&lt; <span class="stringliteral">"        i: For each URL, get the server version."</span> &lt;&lt; endl;
00083     cerr &lt;&lt; <span class="stringliteral">"        d: For each URL, get the DODS DDS."</span> &lt;&lt; endl;
00084     cerr &lt;&lt; <span class="stringliteral">"        a: For each URL, get the DODS DAS."</span> &lt;&lt; endl;
00085     cerr &lt;&lt; <span class="stringliteral">"        A: Use the AIS for DAS objects."</span> &lt;&lt; endl;
00086     cerr &lt;&lt; <span class="stringliteral">"        D: For each URL, get the DODS Data."</span> &lt;&lt; endl;
00087     cerr &lt;&lt; <span class="stringliteral">"        B: &lt;AIS xml dataBase&gt;. Overrides .dodsrc."</span> &lt;&lt;endl;
00088     cerr &lt;&lt; <span class="stringliteral">"        v: Verbose."</span> &lt;&lt; endl;
00089     cerr &lt;&lt; <span class="stringliteral">"        V: Version."</span> &lt;&lt; endl;
00090     cerr &lt;&lt; <span class="stringliteral">"        c: &lt;expr&gt; is a contraint expression. Used with -D."</span> &lt;&lt; endl;
00091     cerr &lt;&lt; <span class="stringliteral">"           NB: You can use a `?' for the CE also."</span> &lt;&lt; endl;
00092     cerr &lt;&lt; <span class="stringliteral">"        k: Keep temporary files created by DODS core\n"</span> &lt;&lt; endl;
00093     cerr &lt;&lt; <span class="stringliteral">"        m: Request the same URL &lt;num&gt; times."</span> &lt;&lt; endl;
00094     cerr &lt;&lt; <span class="stringliteral">"        z: Ask the server to compress data."</span> &lt;&lt; endl;
00095     cerr &lt;&lt; <span class="stringliteral">"        s: Print Sequences using numbered rows."</span> &lt;&lt; endl;
00096 }
00097 
00098 <span class="keywordtype">bool</span>
<a name="l00099"></a><a class="code" href="geturl_8cc.html#a4">00099</a> <a class="code" href="geturl_8cc.html#a4">read_data</a>(FILE *fp)
00100 {
00101     <span class="keywordflow">if</span> (!fp) {
00102     fprintf( stderr, <span class="stringliteral">"geturl: Whoa!!! Null stream pointer.\n"</span> ) ;
00103     <span class="keywordflow">return</span> <span class="keyword">false</span>;
00104     }
00105 
00106     <span class="comment">// Changed from a loop that used getc() to one that uses fread(). getc()</span>
00107     <span class="comment">// worked fine for transfers of text information, but *not* for binary</span>
00108     <span class="comment">// transfers. fread() will handle both.</span>
00109     <span class="keywordtype">char</span> c;
00110     <span class="keywordflow">while</span> (fp &amp;&amp; !feof(fp) &amp;&amp; fread(&amp;c, 1, 1, fp))
00111     printf(<span class="stringliteral">"%c"</span>, c);    <span class="comment">// stick with stdio </span>
00112 
00113     <span class="keywordflow">return</span> <span class="keyword">true</span>;
00114 }
00115 
00116 <span class="keyword">static</span> <span class="keywordtype">void</span>
00117 print_data(<a class="code" href="classDDS.html">DDS</a> &amp;dds, <span class="keywordtype">bool</span> print_rows = <span class="keyword">false</span>)
00118 {
00119     fprintf( stdout, <span class="stringliteral">"The data:\n"</span> ) ;
00120 
00121     <span class="keywordflow">for</span> (<a class="code" href="classDDS.html#DDSw1">DDS::Vars_iter</a> i = dds.<a class="code" href="classDDS.html#DDSa13">var_begin</a>(); i != dds.<a class="code" href="classDDS.html#DDSa14">var_end</a>(); i++) {
00122     <a class="code" href="classBaseType.html">BaseType</a> *v = *i ;
00123     <span class="keywordflow">if</span> (print_rows &amp;&amp; (*i)-&gt;type() == <a class="code" href="BaseType_8h.html#a21a18">dods_sequence_c</a>)
00124         dynamic_cast&lt;Sequence*&gt;(*i)-&gt;print_val_by_rows(stdout);
00125     <span class="keywordflow">else</span>
00126         v-&gt;<a class="code" href="classBaseType.html#Constructora39">print_val</a>(stdout);
00127     }
00128 
00129     fprintf( stdout, <span class="stringliteral">"\n"</span> ) ;
00130     fflush( stdout ) ;
00131 }
00132 
00133 <span class="keywordtype">int</span>
<a name="l00134"></a><a class="code" href="geturl_8cc.html#a6">00134</a> <a class="code" href="usage_8cc.html#a17">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> * argv[])
00135 {
00136     GetOpt getopt (argc, argv, <span class="stringliteral">"idaDAVvkB:c:m:zsh?"</span>);
00137     <span class="keywordtype">int</span> option_char;
00138 
00139     <span class="keywordtype">bool</span> get_das = <span class="keyword">false</span>;
00140     <span class="keywordtype">bool</span> get_dds = <span class="keyword">false</span>;
00141     <span class="keywordtype">bool</span> get_data = <span class="keyword">false</span>;
00142     <span class="keywordtype">bool</span> get_version = <span class="keyword">false</span>;
00143     <span class="keywordtype">bool</span> cexpr = <span class="keyword">false</span>;
00144     <span class="keywordtype">bool</span> verbose = <span class="keyword">false</span>;
00145     <span class="keywordtype">bool</span> multi = <span class="keyword">false</span>;
00146     <span class="keywordtype">bool</span> accept_deflate = <span class="keyword">false</span>;
00147     <span class="keywordtype">bool</span> print_rows = <span class="keyword">false</span>;
00148     <span class="keywordtype">bool</span> use_ais = <span class="keyword">false</span>;
00149     <span class="keywordtype">int</span> times = 1;
00150     string expr = <span class="stringliteral">""</span>;
00151     string ais_db = <span class="stringliteral">""</span>;
00152 
00153 <span class="preprocessor">#ifdef WIN32</span>
00154 <span class="preprocessor"></span>    _setmode(_fileno(stdout), _O_BINARY);
00155 <span class="preprocessor">#endif</span>
00156 <span class="preprocessor"></span>
00157     <span class="keywordflow">while</span> ((option_char = getopt()) != EOF)
00158     <span class="keywordflow">switch</span> (option_char) {
00159       <span class="keywordflow">case</span> <span class="charliteral">'d'</span>: get_dds = <span class="keyword">true</span>; <span class="keywordflow">break</span>;
00160       <span class="keywordflow">case</span> <span class="charliteral">'a'</span>: get_das = <span class="keyword">true</span>; <span class="keywordflow">break</span>;
00161       <span class="keywordflow">case</span> <span class="charliteral">'D'</span>: get_data = <span class="keyword">true</span>; <span class="keywordflow">break</span>;
00162       <span class="keywordflow">case</span> <span class="charliteral">'A'</span>: use_ais = <span class="keyword">true</span>; <span class="keywordflow">break</span>;
00163       <span class="keywordflow">case</span> <span class="charliteral">'V'</span>: fprintf( stderr, <span class="stringliteral">"geturl version: %s\n"</span>, <a class="code" href="das-test_8cc.html#a4">version</a>) ; exit(0);
00164       <span class="keywordflow">case</span> <span class="charliteral">'i'</span>: get_version = <span class="keyword">true</span>; <span class="keywordflow">break</span>;
00165       <span class="keywordflow">case</span> <span class="charliteral">'v'</span>: verbose = <span class="keyword">true</span>; <span class="keywordflow">break</span>;
00166       <span class="keywordflow">case</span> <span class="charliteral">'k'</span>: <a class="code" href="geturl_8cc.html#a2">dods_keep_temps</a> = 1; <span class="keywordflow">break</span>; <span class="comment">// keep_temp is in Connect.cc</span>
00167       <span class="keywordflow">case</span> <span class="charliteral">'c'</span>: cexpr = <span class="keyword">true</span>; expr = getopt.optarg; <span class="keywordflow">break</span>;
00168       <span class="keywordflow">case</span> <span class="charliteral">'m'</span>: multi = <span class="keyword">true</span>; times = atoi(getopt.optarg); <span class="keywordflow">break</span>;
00169       <span class="keywordflow">case</span> <span class="charliteral">'B'</span>: use_ais = <span class="keyword">true</span>; ais_db = getopt.optarg; <span class="keywordflow">break</span>;
00170       <span class="keywordflow">case</span> <span class="charliteral">'z'</span>: accept_deflate = <span class="keyword">true</span>; <span class="keywordflow">break</span>;
00171       <span class="keywordflow">case</span> <span class="charliteral">'s'</span>: print_rows = <span class="keyword">true</span>; <span class="keywordflow">break</span>;
00172       <span class="keywordflow">case</span> <span class="charliteral">'h'</span>:
00173       <span class="keywordflow">case</span> <span class="charliteral">'?'</span>:
00174       <span class="keywordflow">default</span>:
00175         <a class="code" href="error-test_8cc.html#a6">usage</a>(argv[0]); exit(1); <span class="keywordflow">break</span>;
00176     }
00177 
00178     <span class="keywordflow">try</span> {
00179     <span class="comment">// If after processing all the command line options there is nothing</span>
00180     <span class="comment">// left (no URL or file) assume that we should read from stdin.</span>
00181     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = getopt.optind; i &lt; argc; ++i) {
00182         <span class="keywordflow">if</span> (verbose)
00183         fprintf( stderr, <span class="stringliteral">"Fetching: %s\n"</span>, argv[i] ) ;
00184     
00185         string name = argv[i];
00186         <a class="code" href="classConnect.html">Connect</a> *url;
00187         <span class="keywordflow">if</span> (use_ais) {
00188         <span class="keywordflow">if</span> (ais_db != <span class="stringliteral">""</span>)
00189             url = <span class="keyword">new</span> <a class="code" href="classAISConnect.html">AISConnect</a>(name, ais_db);
00190         <span class="keywordflow">else</span>
00191             url = <span class="keyword">new</span> AISConnect(name);
00192         }
00193         <span class="keywordflow">else</span> {
00194         url = <span class="keyword">new</span> <a class="code" href="classConnect.html">Connect</a>(name);
00195         }
00196 
00197         <span class="comment">// This overrides the value set in the .dodsrc file.</span>
00198         <span class="keywordflow">if</span> (accept_deflate)
00199         url-&gt;<a class="code" href="classConnect.html#Connecta7">set_accept_deflate</a>(accept_deflate);
00200 
00201         <span class="keywordflow">if</span> (url-&gt;<a class="code" href="classConnect.html#Connecta3">is_local</a>()) {
00202         <span class="keywordflow">if</span> (verbose) {
00203             fprintf(stderr,
00204                 <span class="stringliteral">"Assuming that the argument %s is a file\n"</span>,
00205                 argv[i]) ;
00206 
00207             fprintf(stderr,
00208                 <span class="stringliteral">"that contains a DODS data object; decoding.\n"</span> );
00209         }
00210 
00211         FILE *source;
00212         <span class="keywordflow">if</span> (strcmp(argv[i], <span class="stringliteral">"-"</span>) == 0)
00213             source = stdin;
00214         <span class="keywordflow">else</span>
00215             source = fopen(argv[i], <span class="stringliteral">"r"</span>);
00216         
00217         <span class="keywordflow">if</span> (!source) {
00218             fprintf( stderr,
00219                  <span class="stringliteral">"The input source: %s could not be opened"</span>,
00220                  argv[i] ) ;
00221             <span class="keyword">delete</span> url;
00222             <span class="keywordflow">break</span>;
00223         }
00224 
00225         <span class="comment">// NB: local access should never use the popup gui.</span>
00226         <span class="keywordflow">try</span> {
00227             <a class="code" href="classDataDDS.html">DataDDS</a> dds;
00228             url-&gt;<a class="code" href="classConnect.html#Connecta15">read_data</a>(dds, source);
00229 
00230             <span class="keywordflow">if</span> (verbose)
00231             fprintf( stderr, <span class="stringliteral">"Server version: %s\n"</span>,
00232                  url-&gt;<a class="code" href="classConnect.html#Connecta10">get_version</a>().c_str() ) ;
00233 
00234             print_data(dds, print_rows);
00235         }
00236         <span class="keywordflow">catch</span> (<a class="code" href="classError.html">Error</a> &amp;e) {
00237             e.display_message();
00238             <span class="keyword">delete</span> url;
00239             <span class="keywordflow">break</span>;
00240         }
00241         <span class="keywordflow">if</span> (source != stdin)
00242             fclose(source);
00243         }
00244 
00245         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (get_version) {
00246         fprintf( stderr, <span class="stringliteral">"Server version: %s\n"</span>,
00247              url-&gt;<a class="code" href="classConnect.html#Connecta11">request_version</a>().c_str() );
00248         }
00249 
00250         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (get_das) {
00251         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; times; ++j) {
00252             <a class="code" href="classDAS.html">DAS</a> das;
00253             <span class="keywordflow">try</span> {
00254             url-&gt;<a class="code" href="classConnect.html#Connecta12">request_das</a>(das);
00255             }
00256             <span class="keywordflow">catch</span> (<a class="code" href="classError.html">Error</a> &amp;e) {
00257             e.display_message();
00258             <span class="keyword">delete</span> url;
00259             <span class="keywordflow">continue</span>;
00260             }
00261 
00262             <span class="keywordflow">if</span> (verbose) {
00263             fprintf( stderr, <span class="stringliteral">"Server version: %s\n"</span>,
00264                      url-&gt;<a class="code" href="classConnect.html#Connecta10">get_version</a>().c_str() ) ; 
00265             fprintf( stderr, <span class="stringliteral">"DAS:\n"</span> ) ;
00266             }
00267 
00268             das.<a class="code" href="classDAS.html#DASa9">print</a>(stdout);
00269         }
00270         }
00271 
00272         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (get_dds) {
00273         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; times; ++j) {
00274             <a class="code" href="classDDS.html">DDS</a> dds;
00275             <span class="keywordflow">try</span> {
00276             url-&gt;<a class="code" href="classConnect.html#Connecta13">request_dds</a>(dds);
00277             }
00278             <span class="keywordflow">catch</span> (<a class="code" href="classError.html">Error</a> &amp;e) {
00279             e.display_message();
00280             <span class="keyword">delete</span> url;
00281             <span class="keywordflow">continue</span>;   <span class="comment">// Goto the next URL or exit the loop.</span>
00282             }
00283 
00284             <span class="keywordflow">if</span> (verbose) {
00285             fprintf( stderr, <span class="stringliteral">"Server version: %s\n"</span>,
00286                      url-&gt;<a class="code" href="classConnect.html#Connecta10">get_version</a>().c_str() ) ; 
00287             fprintf( stderr, <span class="stringliteral">"DDS:\n"</span> ) ;
00288             }
00289 
00290             dds.<a class="code" href="classDDS.html#DDSa43">print</a>(stdout);
00291         }
00292         }
00293 
00294         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (get_data) {
00295         <span class="keywordflow">if</span> (expr.empty() &amp;&amp; name.find(<span class="charliteral">'?'</span>) == string::npos)
00296             expr = <span class="stringliteral">""</span>;
00297 
00298         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; times; ++j) {
00299             <a class="code" href="classDataDDS.html">DataDDS</a> dds;
00300             <span class="keywordflow">try</span> {
00301             <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"URL: "</span> &lt;&lt; url-&gt;<a class="code" href="classConnect.html#Connecta4">URL</a>(<span class="keyword">false</span>) &lt;&lt; endl);
00302             <a class="code" href="debug_8h.html#a1">DBG</a>(cerr &lt;&lt; <span class="stringliteral">"CE: "</span> &lt;&lt; expr &lt;&lt; endl);
00303             url-&gt;<a class="code" href="classConnect.html#Connecta14">request_data</a>(dds, expr);
00304 
00305             <span class="keywordflow">if</span> (verbose)
00306                 fprintf( stderr, <span class="stringliteral">"Server version: %s\n"</span>,
00307                      url-&gt;<a class="code" href="classConnect.html#Connecta10">get_version</a>().c_str() ) ; 
00308 
00309             print_data(dds, print_rows);
00310             }
00311             <span class="keywordflow">catch</span> (<a class="code" href="classError.html">Error</a> &amp;e) {
00312             e.display_message();
00313             <span class="keyword">delete</span> url;
00314             <span class="keywordflow">continue</span>;
00315             }
00316         }
00317         }
00318 
00319         <span class="keywordflow">else</span> { <span class="comment">// if (!get_das &amp;&amp; !get_dds &amp;&amp; !get_data)</span>
00320         <span class="comment">// This code uses HTTPConnect::fetch_url which cannot be</span>
00321         <span class="comment">// accessed using an instance of Connect. So some of the</span>
00322         <span class="comment">// options supported by other URLs won't work here (e.g., the</span>
00323         <span class="comment">// verbose option doesn't show the server version number).</span>
00324         <a class="code" href="classHTTPConnect.html">HTTPConnect</a> http(<a class="code" href="classRCReader.html#RCReadere0">RCReader::instance</a>());
00325 
00326         <span class="comment">// This overrides the value set in the .dodsrc file.</span>
00327         <span class="keywordflow">if</span> (accept_deflate)
00328             http.<a class="code" href="classHTTPConnect.html#HTTPConnecta3">set_accept_deflate</a>(accept_deflate);
00329 
00330         string url_string = argv[i];
00331         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; times; ++j) {
00332             <span class="keywordflow">try</span> {
00333             <a class="code" href="classResponse.html">Response</a> *r = http.<a class="code" href="classHTTPConnect.html#HTTPConnecta6">fetch_url</a>(url_string);
00334             <span class="keywordflow">if</span> (!<a class="code" href="geturl_8cc.html#a4">read_data</a>(r-&gt;<a class="code" href="classResponse.html#Responsez105_0">get_stream</a>())) {
00335                 <span class="keywordflow">continue</span>;
00336             }
00337             <span class="keyword">delete</span> r;
00338             }
00339             <span class="keywordflow">catch</span> (<a class="code" href="classError.html">Error</a> &amp;e) {
00340             e.display_message();
00341             <span class="keywordflow">continue</span>;
00342             }
00343         }
00344         }
00345 
00346         <span class="keyword">delete</span> url;
00347     }
00348     }
00349     <span class="keywordflow">catch</span> (<a class="code" href="classError.html">Error</a> &amp;e) {
00350     e.display_message();
00351     }
00352 
00353     <span class="keywordflow">return</span> 0;
00354 }
00355 
00356 <span class="comment">// $Log: geturl_8cc-source.html,v $
00356 <span class="comment">// Revision 1.4  2004/02/05 06:51:20  jimg
00356 <span class="comment">// Added/update.
00356 <span class="comment">//</span>
00357 <span class="comment">// Revision 1.69.2.7  2004/02/04 00:05:11  jimg</span>
00358 <span class="comment">// Memory errors: I've fixed a number of memory errors (leaks, references)</span>
00359 <span class="comment">// found using valgrind. Many remain. I need to come up with a systematic</span>
00360 <span class="comment">// way of running the tests under valgrind.</span>
00361 <span class="comment">//</span>
00362 <span class="comment">// Revision 1.69.2.6  2003/11/19 18:19:47  jimg</span>
00363 <span class="comment">// Added Get Version to the online doc paragraph.</span>
00364 <span class="comment">//</span>
00365 <span class="comment">// Revision 1.69.2.5  2003/11/19 18:16:56  jimg</span>
00366 <span class="comment">// Added a get version feature.</span>
00367 <span class="comment">//</span>
00368 <span class="comment">// Revision 1.69.2.4  2003/07/29 00:53:07  jimg</span>
00369 <span class="comment">// I fixed a bug where -c "" failed because the code wanted a non-null CE. Null</span>
00370 <span class="comment">// CEs should work.</span>
00371 <span class="comment">//</span>
00372 <span class="comment">// Revision 1.69.2.3  2003/07/16 04:25:45  jimg</span>
00373 <span class="comment">// I added a call to set_accept_deflate() when making a straight HTTP request</span>
00374 <span class="comment">// with the -z option. Before this fix, using geturl -z http://... did not sent</span>
00375 <span class="comment">// the ACCEPT_ENCODING: deflate header if DEFLATE was zero in the .dodsrc file.</span>
00376 <span class="comment">//</span>
00377 <span class="comment">// Revision 1.69.2.2  2003/06/14 22:45:16  rmorris</span>
00378 <span class="comment">// Removed #ifdef's in regards to return value differences in main() for</span>
00379 <span class="comment">// VC++ versus other.</span>
00380 <span class="comment">//</span>
00381 <span class="comment">// Revision 1.69.2.1  2003/05/06 22:04:16  jimg</span>
00382 <span class="comment">// I changed the sense of the -z option. Before it meant don't compress, now it</span>
00383 <span class="comment">// means do compress. The value of DEFLATE in .dodsrc should determine if</span>
00384 <span class="comment">// compression is on or not, with -z being used to override that value and force</span>
00385 <span class="comment">// compression to be used. That's now the case.</span>
00386 <span class="comment">//</span>
00387 <span class="comment">// Revision 1.69  2003/04/22 19:40:28  jimg</span>
00388 <span class="comment">// Merged with 3.3.1.</span>
00389 <span class="comment">//</span>
00390 <span class="comment">// Revision 1.68  2003/03/14 20:04:48  jimg</span>
00391 <span class="comment">// I tidied up process_data and changed its name to print_data. Removed</span>
00392 <span class="comment">// &lt;assert.h&gt;. Added more instrumentation.</span>
00393 <span class="comment">//</span>
00394 <span class="comment">// Revision 1.67  2003/03/12 01:07:34  jimg</span>
00395 <span class="comment">// Added regular expressions to the AIS subsystem. In an AIS database (XML)</span>
00396 <span class="comment">// it is now possible to list a regular expression in place of an explicit</span>
00397 <span class="comment">// URL. The AIS will try to match this Regexp against candidate URLs and</span>
00398 <span class="comment">// return the ancillary resources for all those that succeed.</span>
00399 <span class="comment">//</span>
00400 <span class="comment">// Revision 1.66  2003/03/04 21:09:32  jimg</span>
00401 <span class="comment">// Updated geturl to match changes in the Connect, HTTPConnect and HTTPCache</span>
00402 <span class="comment">// classes. In addition, the program can be used with the prototype AIS (which</span>
00403 <span class="comment">// works for DAS objects only). See the -A option.</span>
00404 <span class="comment">//</span>
00405 <span class="comment">// Revision 1.65  2003/02/27 23:41:49  jimg</span>
00406 <span class="comment">// Updated this to use the new, non-deprecated, methods in Connect (and</span>
00407 <span class="comment">// AISConnect!). The code is a bit tighter. Added a new option, -A, which tells</span>
00408 <span class="comment">// geturl to use the AIS when resolving a URL. In its current incarnation (early</span>
00409 <span class="comment">// prototype) this just handles DAS objects and only uses a single AIS database</span>
00410 <span class="comment">// found by looking for the AIS_DATABASE entry in the ~/.dodsrc configuration</span>
00411 <span class="comment">// file.</span>
00412 <span class="comment">//</span>
00413 <span class="comment">// Revision 1.64  2003/02/21 00:14:25  jimg</span>
00414 <span class="comment">// Repaired copyright.</span>
00415 <span class="comment">//</span>
00416 <span class="comment">// Revision 1.63.2.1  2003/02/21 00:10:08  jimg</span>
00417 <span class="comment">// Repaired copyright.</span>
00418 <span class="comment">//</span>
00419 <span class="comment">// Revision 1.63  2003/01/23 00:22:25  jimg</span>
00420 <span class="comment">// Updated the copyright notice; this implementation of the DAP is</span>
00421 <span class="comment">// copyrighted by OPeNDAP, Inc.</span>
00422 <span class="comment">//</span>
00423 <span class="comment">// Revision 1.62  2003/01/10 19:46:41  jimg</span>
00424 <span class="comment">// Merged with code tagged release-3-2-10 on the release-3-2 branch. In many</span>
00425 <span class="comment">// cases files were added on that branch (so they appear on the trunk for</span>
00426 <span class="comment">// the first time).</span>
00427 <span class="comment">//</span>
00428 <span class="comment">// Revision 1.52.2.22  2002/12/24 00:26:10  jimg</span>
00429 <span class="comment">// Modified to use the current interface of Connect; removed calls to deprecated</span>
00430 <span class="comment">// methods.</span>
00431 <span class="comment">//</span>
00432 <span class="comment">// Revision 1.52.2.21  2002/12/18 23:27:01  pwest</span>
00433 <span class="comment">// verbose message was being printed when not in verbose mode.</span>
00434 <span class="comment">//</span>
00435 <span class="comment">// Revision 1.52.2.20  2002/12/17 22:35:03  pwest</span>
00436 <span class="comment">// Added and updated methods using stdio. Deprecated methods using iostream.</span>
00437 <span class="comment">//</span>
00438 <span class="comment">// Revision 1.52.2.19  2002/10/28 21:17:44  pwest</span>
00439 <span class="comment">// Converted all return values and method parameters to use non-const iterator.</span>
00440 <span class="comment">// Added operator== and operator!= methods to IteratorAdapter to handle Pix</span>
00441 <span class="comment">// problems.</span>
00442 <span class="comment">//</span>
00443 <span class="comment">// Revision 1.52.2.18  2002/09/05 22:52:55  pwest</span>
00444 <span class="comment">// Replaced the GNU data structures SLList and DLList with the STL container</span>
00445 <span class="comment">// class vector&lt;&gt;. To maintain use of Pix, changed the Pix.h header file to</span>
00446 <span class="comment">// redefine Pix to be an IteratorAdapter. Usage remains the same and all code</span>
00447 <span class="comment">// outside of the DAP should compile and link with no problems. Added methods</span>
00448 <span class="comment">// to the different classes where Pix is used to include methods to use STL</span>
00449 <span class="comment">// iterators. Replaced the use of Pix within the DAP to use iterators instead.</span>
00450 <span class="comment">// Updated comments for documentation, updated the test suites, and added some</span>
00451 <span class="comment">// unit tests. Updated the Makefile to remove GNU/SLList and GNU/DLList.</span>
00452 <span class="comment">//</span>
00453 <span class="comment">// Revision 1.52.2.17  2002/08/22 21:23:23  jimg</span>
00454 <span class="comment">// Fixes for the Win32 Build made at ESRI by Vlad Plenchoy and myslef.</span>
00455 <span class="comment">//</span>
00456 <span class="comment">// Revision 1.52.2.16  2002/07/06 19:17:28  jimg</span>
00457 <span class="comment">// I fixed the `read from stdin/file' behavior. This was broken when I switched</span>
00458 <span class="comment">// from libwww to libcurl-&gt;</span>
00459 <span class="comment">//</span>
00460 <span class="comment">// Revision 1.52.2.15  2002/06/20 03:18:48  jimg</span>
00461 <span class="comment">// Fixes and modifications to the Connect and HTTPConnect classes. Neither</span>
00462 <span class="comment">// of these two classes is complete, but they should compile and their</span>
00463 <span class="comment">// basic functions should work.</span>
00464 <span class="comment">//</span>
00465 <span class="comment">// Revision 1.52.2.14  2002/06/18 22:59:06  jimg</span>
00466 <span class="comment">// As part of the switch to libcurl, I had to edit this file. The raw access to</span>
00467 <span class="comment">// HTTP now uses an instnace of HTTPConnect, not Connect.</span>
00468 <span class="comment">//</span>
00469 <span class="comment">// Revision 1.61  2002/06/03 22:21:16  jimg</span>
00470 <span class="comment">// Merged with release-3-2-9</span>
00471 <span class="comment">//</span>
00472 <span class="comment">// Revision 1.61  2002/06/03 22:21:16  jimg</span>
00473 <span class="comment">// Merged with release-3-2-9</span>
00474 <span class="comment">// Revision 1.52.2.13  2002/05/28 22:32:32  jimg</span>
00475 <span class="comment">// This client no longer links with the Test* classes. The DAP implementation</span>
00476 <span class="comment">// was changed so that it no longer requires clients to subclass the data type</span>
00477 <span class="comment">// classes.</span>
00478 <span class="comment">//</span>
00479 <span class="comment">// Revision 1.52.2.12  2002/05/27 01:08:30  jimg</span>
00480 <span class="comment">// Removed the last vestiges of the progress indicator code in this simple</span>
00481 <span class="comment">// client.</span>
00482 <span class="comment">//</span>
00483 <span class="comment">// Revision 1.52.2.11  2002/02/04 19:04:06  jimg</span>
00484 <span class="comment">// Fixed bad use of delete (shouldhave been delete[])</span>
00485 <span class="comment">//</span>
00486 <span class="comment">// Revision 1.52.2.10  2001/10/30 06:55:45  rmorris</span>
00487 <span class="comment">// Win32 porting changes.  Brings core win32 port up-to-date.</span>
00488 <span class="comment">//</span>
00489 <span class="comment">// Revision 1.60  2001/10/29 21:17:06  jimg</span>
00490 <span class="comment">// Fixed bad job of resolving conflict(s) from the last merge.</span>
00491 <span class="comment">//</span>
00492 <span class="comment">// Revision 1.59  2001/10/14 01:28:38  jimg</span>
00493 <span class="comment">// Merged with release-3-2-8.</span>
00494 <span class="comment">//</span>
00495 <span class="comment">// Revision 1.52.2.9  2001/10/08 16:53:35  jimg</span>
00496 <span class="comment">// Added url.gui() to all calls to Error::display_message(). This prevents a</span>
00497 <span class="comment">// seg fault when display_message is called with nothing (gui == null) but</span>
00498 <span class="comment">// has been ompiled with GUI defined.</span>
00499 <span class="comment">//</span>
00500 <span class="comment">// Revision 1.58  2001/09/28 17:50:07  jimg</span>
00501 <span class="comment">// Merged with 3.2.7.</span>
00502 <span class="comment">//</span>
00503 <span class="comment">// Revision 1.52.2.8  2001/09/07 00:38:35  jimg</span>
00504 <span class="comment">// Sequence::deserialize(...) now reads all the sequence values at once.</span>
00505 <span class="comment">// Its call semantics are the same as the other classes' versions. Values</span>
00506 <span class="comment">// are stored in the Sequence object using a vector&lt;BaseType *&gt; for each</span>
00507 <span class="comment">// row (those are themselves held in a vector). Three new accessor methods</span>
00508 <span class="comment">// have been added to Sequence (row_value() and two versions of var_value()).</span>
00509 <span class="comment">// BaseType::deserialize(...) now always returns true. This matches with the</span>
00510 <span class="comment">// expectations of most client code (the seqeunce version returned false</span>
00511 <span class="comment">// when it was done reading, but all the calls for sequences must be changed</span>
00512 <span class="comment">// anyway). If an XDR error is found, deserialize throws InternalErr.</span>
00513 <span class="comment">//</span>
00514 <span class="comment">// Revision 1.57  2001/08/24 17:46:22  jimg</span>
00515 <span class="comment">// Resolved conflicts from the merge of release 3.2.6</span>
00516 <span class="comment">//</span>
00517 <span class="comment">// Revision 1.52.2.7  2001/07/28 01:10:42  jimg</span>
00518 <span class="comment">// Some of the numeric type classes did not have copy ctors or operator=.</span>
00519 <span class="comment">// I added those where they were needed.</span>
00520 <span class="comment">// In every place where delete (or delete []) was called, I set the pointer</span>
00521 <span class="comment">// just deleted to zero. Thus if for some reason delete is called again</span>
00522 <span class="comment">// before new memory is allocated there won't be a mysterious crash. This is</span>
00523 <span class="comment">// just good form when using delete.</span>
00524 <span class="comment">// I added calls to www2id and id2www where appropriate. The DAP now handles</span>
00525 <span class="comment">// making sure that names are escaped and unescaped as needed. Connect is</span>
00526 <span class="comment">// set to handle CEs that contain names as they are in the dataset (see the</span>
00527 <span class="comment">// comments/Log there). Servers should not handle escaping or unescaping</span>
00528 <span class="comment">// characters on their own.</span>
00529 <span class="comment">//</span>
00530 <span class="comment">// Revision 1.52.2.6  2001/07/11 05:31:03  jimg</span>
00531 <span class="comment">// If geturl's ``read from file or stdin'' feature is used and the filename or</span>
00532 <span class="comment">// redirect is null, an error message is printed. Before geturl dumped core.</span>
00533 <span class="comment">//</span>
00534 <span class="comment">// Revision 1.56  2001/06/15 23:49:04  jimg</span>
00535 <span class="comment">// Merged with release-3-2-4.</span>
00536 <span class="comment">//</span>
00537 <span class="comment">// Revision 1.52.2.5  2001/06/07 20:43:39  jimg</span>
00538 <span class="comment">// Fixed a bug in process_data() when reading structures that contain</span>
00539 <span class="comment">// sequences.</span>
00540 <span class="comment">//</span>
00541 <span class="comment">// Revision 1.52.2.4  2001/05/23 16:56:09  jimg</span>
00542 <span class="comment">// Now reads data responses from stdin and files. The responses *must* have</span>
00543 <span class="comment">// MIME headers.</span>
00544 <span class="comment">// Correctly handles data responses read locally that are actually Error</span>
00545 <span class="comment">// objects.</span>
00546 <span class="comment">//</span>
00547 <span class="comment">// Revision 1.52.2.3  2001/05/04 00:13:33  jimg</span>
00548 <span class="comment">// Fixed a bug in where one of Connect's FILE *s was closed w/o using</span>
00549 <span class="comment">// Connect::close_output(). This can cause clients to crash later on when</span>
00550 <span class="comment">// Connect tries to close the FILE * itself.</span>
00551 <span class="comment">//</span>
00552 <span class="comment">// Revision 1.52.2.2  2001/02/14 00:10:05  jimg</span>
00553 <span class="comment">// Merged code from the trunk's HEAD revision for this/these files onto</span>
00554 <span class="comment">// the release-3-2 branch. This moves the authentication software onto the</span>
00555 <span class="comment">// release-3-2 branch so that it will be easier to get it in the 3.2 release.</span>
00556 <span class="comment">//</span>
00557 <span class="comment">// Revision 1.54  2001/02/09 22:07:18  jimg</span>
00558 <span class="comment">// Removed some of the #ifdef WIN32 guards since the code works with g++ too.</span>
00559 <span class="comment">// Fixed an error in the usage string.</span>
00560 <span class="comment">//</span>
00561 <span class="comment">// Revision 1.53  2001/01/26 19:48:09  jimg</span>
00562 <span class="comment">// Merged with release-3-2-3.</span>
00563 <span class="comment">//</span>
00564 <span class="comment">// Revision 1.52.2.1  2000/12/05 00:32:58  jimg</span>
00565 <span class="comment">// Fixed indentation in places.</span>
00566 <span class="comment">//</span>
00567 <span class="comment">// Revision 1.52  2000/10/30 17:21:28  jimg</span>
00568 <span class="comment">// Added support for proxy servers (from cjm).</span>
00569 <span class="comment">//</span>
00570 <span class="comment">// Revision 1.51  2000/09/22 02:17:23  jimg</span>
00571 <span class="comment">// Rearranged source files so that the CVS logs appear at the end rather than</span>
00572 <span class="comment">// the start. Also made the ifdef guard symbols use the same naming scheme and</span>
00573 <span class="comment">// wrapped headers included in other headers in those guard symbols (to cut</span>
00574 <span class="comment">// down on extraneous file processing - See Lakos).</span>
00575 <span class="comment">//</span>
00576 <span class="comment">// Revision 1.50  2000/09/11 16:39:23  jimg</span>
00577 <span class="comment">// Changed the name of Sequence::get_row_numbers() ...</span>
00578 <span class="comment">//</span>
00579 <span class="comment">// Revision 1.49  2000/08/31 00:28:02  rmorris</span>
00580 <span class="comment">// Fixed lost mod for port to win32 - newlines in string constanct</span>
00581 <span class="comment">// not ok with VC++.  (this was in usage()).</span>
00582 <span class="comment">//</span>
00583 <span class="comment">// Revision 1.48  2000/08/16 00:39:17  jimg</span>
00584 <span class="comment">// Added an option (-s) to test the Sequence::getRowNumber method.</span>
00585 <span class="comment">//</span>
00586 <span class="comment">// Revision 1.47  2000/08/08 20:46:17  rmorris</span>
00587 <span class="comment">// Trivial removal of a hack fragment left behind from a earlier fix.</span>
00588 <span class="comment">//</span>
00589 <span class="comment">// Revision 1.46  2000/08/07 21:41:47  rmorris</span>
00590 <span class="comment">// Reversed hack related to 7/19/00 and 7/21/00 changes to get around</span>
00591 <span class="comment">// a bug in the core (which has been fixed).</span>
00592 <span class="comment">//</span>
00593 <span class="comment">// Revision 1.45  2000/07/21 14:29:17  rmorris</span>
00594 <span class="comment">// Put a temporary fix in that is in lieu of an upcoming small change</span>
00595 <span class="comment">// to the core.  Is in an ifdef with a note to remove it - but the</span>
00596 <span class="comment">// temporary hack will work with or without the change to the core.</span>
00597 <span class="comment">// See TMPHACK ifdef's to remove.</span>
00598 <span class="comment">//</span>
00599 <span class="comment">// Revision 1.44  2000/07/19 22:45:21  rmorris</span>
00600 <span class="comment">// Delete the right type of dds (a DataDDS) so that when it</span>
00601 <span class="comment">// is deleted, the destructors are called in the right sequence.</span>
00602 <span class="comment">// This might be the case under win32 only (??), but I would think</span>
00603 <span class="comment">// this change is applicable to unix also.</span>
00604 <span class="comment">//</span>
00605 <span class="comment">// Revision 1.43  2000/07/18 03:43:42  rmorris</span>
00606 <span class="comment">// Change to set stdout to binary mode under win32 so that the output of geturl</span>
00607 <span class="comment">// yields the exact same thing as it does Unix - i.e., no cr-nl translation</span>
00608 <span class="comment">// of nl's within the output.</span>
00609 <span class="comment">//</span>
00610 <span class="comment">// Revision 1.42  2000/07/09 22:05:36  rmorris</span>
00611 <span class="comment">// Changes to increase portability, minimize ifdef's for win32 and account</span>
00612 <span class="comment">// for differences in the iostreams implementations.</span>
00613 <span class="comment">//</span>
00614 <span class="comment">// Revision 1.41  2000/06/07 18:07:01  jimg</span>
00615 <span class="comment">// Merged the pc port branch</span>
00616 <span class="comment">//</span>
00617 <span class="comment">// Revision 1.40.10.1  2000/06/02 18:39:03  rmorris</span>
00618 <span class="comment">// Mod's for port to win32.</span>
00619 <span class="comment">//</span>
00620 <span class="comment">// Revision 1.40  1999/08/23 18:57:46  jimg</span>
00621 <span class="comment">// Merged changes from release 3.1.0</span>
00622 <span class="comment">//</span>
00623 <span class="comment">// Revision 1.39.2.1  1999/08/09 22:57:51  jimg</span>
00624 <span class="comment">// Removed GUI code; reactivate by defining GUI</span>
00625 <span class="comment">//</span>
00626 <span class="comment">// Revision 1.39  1999/08/09 18:27:35  jimg</span>
00627 <span class="comment">// Merged changes from Brent for the Gui code (progress indicator)</span>
00628 <span class="comment">//</span>
00629 <span class="comment">// Revision 1.38  1999/07/22 17:11:52  jimg</span>
00630 <span class="comment">// Merged changes from the release-3-0-2 branch</span>
00631 <span class="comment">//</span>
00632 <span class="comment">// Revision 1.37.4.2  1999/06/11 10:21:50  rmorris</span>
00633 <span class="comment">// Removed a couple of debugging lines accidentally returned to cvs</span>
00634 <span class="comment">//</span>
00635 <span class="comment">// Revision 1.37.4.1  1999/06/04 22:34:36  rmorris</span>
00636 <span class="comment">// Fixed a line that was causing core dumps during the generation and running</span>
00637 <span class="comment">// of the hdf server test suites.  It looks like there was a simple cut-and-paste</span>
00638 <span class="comment">// error made by someone earlier involving the outputting of Structures - they</span>
00639 <span class="comment">// were being treated like sequences.</span>
00640 <span class="comment">//</span>
00641 <span class="comment">// Revision 1.37  1999/05/26 17:35:01  jimg</span>
00642 <span class="comment">// The Gui option is now disabled; gui is always false.</span>
00643 <span class="comment">// One call to gui()-&gt;... has been removed with #if 0 ... #endif.</span>
00644 <span class="comment">//</span>
00645 <span class="comment">// Revision 1.36  1999/04/29 02:29:36  jimg</span>
00646 <span class="comment">// Merge of no-gnu branch</span>
00647 <span class="comment">//</span>
00648 <span class="comment">// Revision 1.35  1999/04/22 22:30:52  jimg</span>
00649 <span class="comment">// Uses dynamic_cast</span>
00650 <span class="comment">//</span>
00651 <span class="comment">// Revision 1.34  1999/02/22 22:45:10  jimg</span>
00652 <span class="comment">// Added -T option: Use this to send a list of accepted types to the server</span>
00653 <span class="comment">// using the new XDODS-Accept-Types request header. The list must not contain</span>
00654 <span class="comment">// spaces *even* if it is quoted.</span>
00655 <span class="comment">//</span>
00656 <span class="comment">// Revision 1.33  1998/11/10 00:47:53  jimg</span>
00657 <span class="comment">// Delete the dds object (created with new) after calling process_data().</span>
00658 <span class="comment">//</span>
00659 <span class="comment">// Revision 1.32  1998/09/08 22:23:51  jimg</span>
00660 <span class="comment">// Removed PERF macro calls.</span>
00661 <span class="comment">//</span>
00662 <span class="comment">// Revision 1.31.6.2  1999/02/05 09:32:36  jimg</span>
00663 <span class="comment">// Fixed __unused__ so that it not longer clashes with Red Hat 5.2 inlined</span>
00664 <span class="comment">// math code. </span>
00665 <span class="comment">//</span>
00666 <span class="comment">// Revision 1.31.6.1  1999/02/02 21:57:08  jimg</span>
00667 <span class="comment">// String to string version</span>
00668 <span class="comment">//</span>
00669 <span class="comment">// Revision 1.31  1998/04/03 17:46:04  jimg</span>
00670 <span class="comment">// Patch from Jake Hamby; fixed bug where Structures which contained sequences</span>
00671 <span class="comment">// did not print properly.</span>
00672 <span class="comment">//</span>
00673 <span class="comment">// Revision 1.30  1998/03/20 00:23:25  jimg</span>
00674 <span class="comment">// Improved the error message reporting.</span>
00675 <span class="comment">//</span>
00676 <span class="comment">// Revision 1.29  1998/02/19 19:45:00  jimg</span>
00677 <span class="comment">// Changed error messages so that ones from geturl that are not obviously from</span>
00678 <span class="comment">// geturl are prefixed by `geturl: '.</span>
00679 <span class="comment">//</span>
00680 <span class="comment">// Revision 1.28  1998/02/11 22:34:23  jimg</span>
00681 <span class="comment">// Added support for on-the-fly decompression.</span>
00682 <span class="comment">// Added -z flag to suppress requesting data be compressed.</span>
00683 <span class="comment">// Added new trace options (libwww core, etc.).</span>
00684 <span class="comment">//</span>
00685 <span class="comment">// Revision 1.27  1998/02/05 20:14:04  jimg</span>
00686 <span class="comment">// DODS now compiles with gcc 2.8.x</span>
00687 <span class="comment">//</span>
00688 <span class="comment">// Revision 1.26  1997/10/09 22:19:32  jimg</span>
00689 <span class="comment">// Resolved conflicts in merge of 2.14c to trunk.</span>
00690 <span class="comment">//</span>
00691 <span class="comment">// Revision 1.25  1997/10/04 00:33:06  jimg</span>
00692 <span class="comment">// Release 2.14c fixes</span>
00693 <span class="comment">//</span>
00694 <span class="comment">// Revision 1.24  1997/09/22 22:26:34  jimg</span>
00695 <span class="comment">// Rewrote the handling of received Sequences in `constrained-trans()'.</span>
00696 <span class="comment">//</span>
00697 <span class="comment">// Revision 1.23.6.1  1997/09/23 15:44:33  jimg</span>
00698 <span class="comment">// Now prints newline at end of data output</span>
00699 <span class="comment">//</span>
00700 <span class="comment">// Revision 1.23  1997/06/05 23:08:51  jimg</span>
00701 <span class="comment">// Modified so that data can be read from stdin (similar to writeval).</span>
00702 <span class="comment">//</span>
00703 <span class="comment">// Revision 1.22  1997/03/05 08:29:32  jimg</span>
00704 <span class="comment">// Silly bug where show_gui() was not called in some cases.</span>
00705 <span class="comment">//</span>
00706 <span class="comment">// Revision 1.21  1997/02/17 20:28:15  jimg</span>
00707 <span class="comment">// Changed output of verbose option so it is consistent for DAS, DDS and data</span>
00708 <span class="comment">//</span>
00709 <span class="comment">// Revision 1.20  1997/02/13 17:30:17  jimg</span>
00710 <span class="comment">// Added printout of the DODS version number stamp (read from the MIME header).</span>
00711 <span class="comment">// Use the verbose option to enable display.</span>
00712 <span class="comment">//</span>
00713 <span class="comment">// Revision 1.19  1997/02/13 00:21:28  jimg</span>
00714 <span class="comment">// Added version switch. Made compatible with writeval's command line options.</span>
00715 <span class="comment">//</span>
00716 <span class="comment">// Revision 1.18  1997/02/12 21:45:03  jimg</span>
00717 <span class="comment">// Added use of the optional parameter to Connect's ctor; if -t (trace) is</span>
00718 <span class="comment">// given on the command line, then print www library informational messages.</span>
00719 <span class="comment">// Changed trace option switch from -v (which is now used for verbose - an</span>
00720 <span class="comment">// option that is entirely separate from trace) to -t.</span>
00721 <span class="comment">//</span>
00722 <span class="comment">// Revision 1.17  1997/02/10 02:36:10  jimg</span>
00723 <span class="comment">// Modified usage of request_data() to match new return type.</span>
00724 <span class="comment">//</span>
00725 <span class="comment">// Revision 1.16  1996/12/18 18:43:32  jimg</span>
00726 <span class="comment">// Tried to fix the online help - maybe I succeeded?</span>
00727 <span class="comment">//</span>
00728 <span class="comment">// Revision 1.15  1996/11/27 22:12:33  jimg</span>
00729 <span class="comment">// Expanded help to include all the verbose options.</span>
00730 <span class="comment">// Added PERF macros to code around request_data() call.</span>
00731 <span class="comment">//</span>
00732 <span class="comment">// Revision 1.14  1996/11/20 00:37:47  jimg</span>
00733 <span class="comment">// Modified -D option to correctly process the Asynchronous option.</span>
00734 <span class="comment">//</span>
00735 <span class="comment">// Revision 1.13  1996/11/16 00:20:47  jimg</span>
00736 <span class="comment">// Fixed a bug where multiple urls failed.</span>
00737 <span class="comment">//</span>
00738 <span class="comment">// Revision 1.12  1996/10/31 22:24:05  jimg</span>
00739 <span class="comment">// Fix the help message so that -D is not described as -A...</span>
00740 <span class="comment">//</span>
00741 <span class="comment">// Revision 1.11  1996/10/08 17:13:09  jimg</span>
00742 <span class="comment">// Added test for the -D option so that a Ce can be supplied either with the</span>
00743 <span class="comment">// -c option or using a ? at the end of the URL.</span>
00744 <span class="comment">//</span>
00745 <span class="comment">// Revision 1.10  1996/09/19 16:53:35  jimg</span>
00746 <span class="comment">// Added code to process sequences correctly when given the -D (get data)</span>
00747 <span class="comment">// option.</span>
00748 <span class="comment">//</span>
00749 <span class="comment">// Revision 1.9  1996/09/05 16:28:06  jimg</span>
00750 <span class="comment">// Added a new option to geturl, -D, which uses the Connect::request_data</span>
00751 <span class="comment">// member function to get data. Thus -a, -d and -D can be used to get the</span>
00752 <span class="comment">// das, dds and data from a DODS server. Because the request_data member</span>
00753 <span class="comment">// function requires a constraint expression I also added the option -c; this</span>
00754 <span class="comment">// option takes as a single argument a constraint expression and passes it to</span>
00755 <span class="comment">// the request_data member function. You must use -c &lt;expr&gt; with -D.</span>
00756 <span class="comment">//</span>
00757 <span class="comment">// Revision 1.8  1996/08/13 20:13:36  jimg</span>
00758 <span class="comment">// Added not_used to definition of char rcsid[].</span>
00759 <span class="comment">// Added code so that local `URLs' are skipped.</span>
00760 <span class="comment">//</span>
00761 <span class="comment">// Revision 1.7  1996/06/22 00:11:20  jimg</span>
00762 <span class="comment">// Modified to accomodate the new Gui class.</span>
00763 <span class="comment">//</span>
00764 <span class="comment">// Revision 1.6  1996/06/18 23:55:33  jimg</span>
00765 <span class="comment">// Added support for the GUI progress indicator.</span>
00766 <span class="comment">//</span>
00767 <span class="comment">// Revision 1.5  1996/06/08 00:18:38  jimg</span>
00768 <span class="comment">// Initialized vcode to null.</span>
00769 <span class="comment">//</span>
00770 <span class="comment">// Revision 1.4  1996/05/29 22:05:57  jimg</span>
00771 <span class="comment">// Fixed up the copyright header.</span>
00772 <span class="comment">//</span>
00773 <span class="comment">// Revision 1.3  1996/05/28 17:35:40  jimg</span>
00774 <span class="comment">// Fixed verbose arguments.</span>
00775 <span class="comment">//</span>
00776 <span class="comment">// Revision 1.2  1996/05/28 15:49:55  jimg</span>
00777 <span class="comment">// Removed code that read from the stream after the das/dds parser built the</span>
00778 <span class="comment">// internal object (since there was nothing in that stream after the parse</span>
00779 <span class="comment">// geturl would always crash).</span>
00780 <span class="comment">//</span>
00781 <span class="comment">// Revision 1.1  1996/05/22 23:34:21  jimg</span>
00782 <span class="comment">// First version. Built to test the new WWW code in the class Connect.</span>
00783 <span class="comment">//</span>
00784 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Feb 4 23:43:00 2004 for libdap++ by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
