<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>libdap++: HTTPCache class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>HTTPCache Class Reference</h1><code>#include &lt;<a class="el" href="HTTPCache_8h-source.html">HTTPCache.h</a>&gt;</code>
<p>
Collaboration diagram for HTTPCache:<p><center><img src="classHTTPCache__coll__graph.png" border="0" usemap="#HTTPCache__coll__map" alt="Collaboration graph"></center>
<center><font size="2">[<a href="graph_legend.html">legend</a>]</font></center><a href="classHTTPCache-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Cache Index</h2></td></tr>
<tr><td colspan=2>These methods manage the cache's index file. Each cache holds an index file named <code></code>.index which stores the cache's state information. <br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez29_0">cache_index_write</a> ()  throw (Error)</td></tr>

<tr><td colspan=2><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>virtual&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachea0">~HTTPCache</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachea1">cache_response</a> (const  string &amp;url, time_t request_time, const  vector&lt; string &gt; &amp;headers, const  FILE *body)  throw (Error, InternalErr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>vector&lt; string &gt;&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachea2">get_conditional_request_headers</a> (const  string &amp;url)  throw (Error)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachea3">update_response</a> (const  string &amp;url, time_t request_time, const  vector&lt; string &gt; &amp;headers)  throw (Error)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachea4">is_url_in_cache</a> (const  string &amp;url)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachea5">is_url_valid</a> (const  string &amp;url)  throw (Error)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>FILE *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachea6">get_cached_response</a> (const  string &amp;url, vector&lt; string &gt; &amp;headers)  throw (Error, InternalErr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>FILE *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachea7">get_cached_response_body</a> (const  string &amp;url)  throw (Error, InternalErr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachea8">release_cached_response</a> (FILE *response)  throw (Error)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachea9">purge_cache</a> ()  throw (Error)</td></tr>

<tr><td colspan="2"><div class="groupHeader">Accessors and Mutators for various properties.</div></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>string&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_0">get_cache_root</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_1">set_cache_enabled</a> (bool mode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_2">is_cache_enabled</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_3">set_cache_protected</a> (bool mode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_4">is_cache_protected</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_5">set_cache_disconnected</a> (<a class="el" href="HTTPCacheDisconnectedMode_8h.html#a3">CacheDisconnectedMode</a> mode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="HTTPCacheDisconnectedMode_8h.html#a3">CacheDisconnectedMode</a>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_6">get_cache_disconnected</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_7">set_expire_ignored</a> (bool mode)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_8">is_expire_ignored</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_9">set_max_size</a> (unsigned long size)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned long&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_10">get_max_size</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_11">set_max_entry_size</a> (unsigned long size)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>unsigned long&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_12">get_max_entry_size</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_13">set_default_expiration</a> (int exp_time)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>int&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_14">get_default_expiration</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_15">set_always_validate</a> (bool validate)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_16">get_always_validate</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_17">set_cache_control</a> (const  vector&lt; string &gt; &amp;cc)  throw (InternalErr)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>vector&lt; string &gt;&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachez35_18">get_cache_control</a> ()</td></tr>

<tr><td colspan=2><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top><a class="el" href="classHTTPCache.html">HTTPCache</a> *&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachee0">instance</a> (const  string &amp;cache_root, bool force=false)  throw (Error)</td></tr>

<tr><td colspan=2><br><h2>Friends</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>class&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachen0">HTTPCacheTest</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>class&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachen1">DeleteExpired</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>class&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachen2">DeleteByHits</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>class&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachen3">DeleteCacheEntry</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>class&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachen4">DeleteUnlockedCacheEntry</a></td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>class&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classHTTPCache.html#HTTPCachen5">WriteOneCacheEntry</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Implements a single-user MT-safe HTTP 1.1 compliant (mostly) cache.<p>
<em>Clients that run as users lacking a writable HOME directory MUST disable this cache. Use Connect::set_cache_enable(false).</em><p>
The design of this class was taken from the W3C libwww software. That code was originally written by Henrik Frystyk Nielsen, Copyright MIT 1995. See the file MIT_COPYRIGHT. This software is a complete rewrite in C++ with additional features useful to the DODS and OPeNDAP projects.<p>
This cache does not implement range checking. Partial responses should not be cached (HFN's version did, but it doesn't mesh well with the DAP for which this is being written).<p>
The cache uses the local file system to store responses. If it is being used in a MT application, care should be taken to ensure that the number of available file descriptors is not exceeded.<p>
In addition, when used in a MT program only one thread should use the mutators to set property values. Even though the methods are robust WRT MT software, having several threads change values of cache's properties will lead to odd behavior on the part of the cache. Many of the public methods lock access to the class' interface. This is noted in the documentation for those methods.<p>
Even though the public interface to the cache is typically locked when accessed, an extra locking mechanism is in place for `entries' which are accessed. If a thread accesses a entry, that response must be locked to prevent it from being updated until the thread tells the cache that it's no longer using it. The methods get_cache_response() and get_cache_response_body() both lock an entry; use release_cache_response() to release the lock. Entries are locked using a combination of a counter and a mutex. The following methods block when called on a locked entry: <a class="el" href="classHTTPCache.html#HTTPCachea5">is_url_valid()</a>, <a class="el" href="classHTTPCache.html#HTTPCachea2">get_conditional_request_headers()</a>, <a class="el" href="classHTTPCache.html#HTTPCachea3">update_response()</a>. (The locking scheme could be modified so that a distinction is made between reading from and writing to an entry. In this case <a class="el" href="classHTTPCache.html#HTTPCachea5">is_url_valid()</a> and <a class="el" href="classHTTPCache.html#HTTPCachea2">get_conditional_request_headers()</a> would only lock when an entry is in use for writing. But I haven't done that.)<p>
<dl compact><dt><b><a class="el" href="todo.html#_todo000014">Todo:</a></b></dt><dd>Because <a class="el" href="classHTTPCache.html#HTTPCachea4">is_url_in_cache()</a> and <a class="el" href="classHTTPCache.html#HTTPCachea5">is_url_valid()</a> are discrete, an interface that combines the two might be easier to use. Or maybe if <a class="el" href="classHTTPCache.html#HTTPCachea5">is_url_valid()</a> threw a special exception if the entry was missing. Something to help clients deal with URLs that are removed from the cache in between calls to the two methods. <p>
Change the entry locking scheme to distinguish between entries accessed for reading and for writing. <p>
Test in MT software. Is the entry locking scheme good enough? The current software throws an exception if there's an attempt to modify an entry that is locked by another thread. Maybe it should block instead? Maybe we should provide a tests to see if an update would block (one that returns right away and one that blocks). Note: Rob Morris added tests for MT-safety. 02/06/03 jhrg </dd></dl>
<p>
<dl compact><dt><b>Author:</b></dt><dd>James Gallagher &lt;<a href="mailto:jgallagher@gso.uri.edu">jgallagher@gso.uri.edu</a>&gt; </dd></dl>

<p>

<p>
Definition at line <a class="el" href="HTTPCache_8h-source.html#l00137">137</a> of file <a class="el" href="HTTPCache_8h-source.html">HTTPCache.h</a>.<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="HTTPCachea0" doxytag="HTTPCache::~HTTPCache" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> HTTPCache::~<a class="el" href="classHTTPCache.html">HTTPCache</a> </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [virtual]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Destroy an instance of HTTPCache. This writes the cache index and frees the in-memory cache table structure. The persistent cache (the response headers and bodies and the index file) are not removed. To remove those, either erase the directory that contains the cache using a file system command or use the <a class="el" href="classHTTPCache.html#HTTPCachea9">purge_cache()</a> method (which leaves the cache directory structure in place but removes all the cached information).<p>
This class uses the singleton pattern. Clients should <em>never</em> call this method. The <a class="el" href="classHTTPCache.html#HTTPCachee0">HTTPCache::instance()</a> method arranges to call the HTTPCache::delete_instance() using <code>atexit()</code>. If delete is called more than once, the result will likely be an index file that is corrupt. 
<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l00287">287</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="HTTPCache_8cc-source.html#l00469">cache_index_write()</a>, <a class="el" href="HTTPCache_8h-source.html#l00076">CACHE_TABLE_SIZE</a>, <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00064">DBG2</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00063">DESTROY</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="HTTPCachez29_0" doxytag="HTTPCache::cache_index_write" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::cache_index_write </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>  throw (<a class="el" href="classError.html">Error</a>)</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Walk through the list of cached objects and write the cache index file to disk. If the file does not exist, it is created. If the file does exist, it is overwritten. As a side effect, zero the new_entries counter.<p>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Error</em>&nbsp;</td><td>Thrown if the index file cannot be opened for writing. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Note:</b></dt><dd>The HTTPCache destructor calls this method and silently ignores this exception. </dd></dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l00469">469</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="HTTPCache_8h-source.html#l00076">CACHE_TABLE_SIZE</a>, <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.
<p>
Referenced by <a class="el" href="HTTPCache_8cc-source.html#l01173">set_max_entry_size()</a>, <a class="el" href="HTTPCache_8cc-source.html#l01114">set_max_size()</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00287">~HTTPCache()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachea1" doxytag="HTTPCache::cache_response" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool HTTPCache::cache_response </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>url</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>time_t&nbsp;</td>
          <td class="mdname" nowrap> <em>request_time</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const vector&lt; string &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>headers</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const FILE *&nbsp;</td>
          <td class="mdname" nowrap> <em>body</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throw (<a class="el" href="classError.html">Error</a>, <a class="el" href="classInternalErr.html">InternalErr</a>)</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Add a new response to the cache, or replace an existing cached response with new data. This method returns True if the information for <code>url</code> was added to the cache. A response might not be cache-able; in that case this method returns false. (For example, the response might contain the 'Cache-Control: no-cache' header.)<p>
Note that the FILE *body is rewound so that the caller can re-read it without using fseek or rewind.<p>
If a response for <code>url</code> is already present in the cache, it will be replaced by the new headers and body. To update a response in the cache with new meta data, use <a class="el" href="classHTTPCache.html#HTTPCachea3">update_response()</a>.<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>url</em>&nbsp;</td><td>A string which holds the request URL. </td></tr>
    <tr><td valign=top><em>request_time</em>&nbsp;</td><td>The time when the request was made, in seconds since 1 Jan 1970. </td></tr>
    <tr><td valign=top><em>headers</em>&nbsp;</td><td>A vector of strings which hold the response headers. </td></tr>
    <tr><td valign=top><em>body</em>&nbsp;</td><td>A FILE * to a file which holds the response body. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>True if the response was cached, False if the response could not be cached. </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>InternalErr</em>&nbsp;</td><td>Thrown if there was a I/O error while writing to the persistent store. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01736">1736</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="HTTPCache_8cc-source.html#l00100">CACHE_META</a>, <a class="el" href="HTTPCache_8h-source.html#l00155">HTTPCache::CacheEntry::cachename</a>, <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00112">DUMP_FREQUENCY</a>, <a class="el" href="HTTPCache_8h-source.html#l00152">HTTPCache::CacheEntry::hash</a>, <a class="el" href="HTTPCache_8h-source.html#l00153">HTTPCache::CacheEntry::hits</a>, <a class="el" href="HTTPCache_8cc-source.html#l00062">INIT</a>, <a class="el" href="HTTPCache_8h-source.html#l00177">HTTPCache::CacheEntry::lock</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, <a class="el" href="HTTPCache_8h-source.html#l00173">HTTPCache::CacheEntry::no_cache</a>, <a class="el" href="HTTPCache_8h-source.html#l00165">HTTPCache::CacheEntry::range</a>, <a class="el" href="HTTPCache_8cc-source.html#l00085">REMOVE</a>, <a class="el" href="HTTPCache_8h-source.html#l00164">HTTPCache::CacheEntry::size</a>, <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>, and <a class="el" href="HTTPCache_8h-source.html#l00151">HTTPCache::CacheEntry::url</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_16" doxytag="HTTPCache::get_always_validate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool HTTPCache::get_always_validate </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Should every cache entry be validated before each use? <dl compact><dt><b>Returns:</b></dt><dd>True if all cache entries require validation. </dd></dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01264">1264</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_18" doxytag="HTTPCache::get_cache_control" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> vector&lt; string &gt; HTTPCache::get_cache_control </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the Cache-Control headers.<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Returns:</b></dt><dd>A vector of strings, one string for each header. </dd></dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01339">1339</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_6" doxytag="HTTPCache::get_cache_disconnected" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="HTTPCacheDisconnectedMode_8h.html#a3">CacheDisconnectedMode</a> HTTPCache::get_cache_disconnected </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the cache's disconnected mode property. 
<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01064">1064</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_0" doxytag="HTTPCache::get_cache_root" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> string HTTPCache::get_cache_root </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the current cache root directory. <dl compact><dt><b>Returns:</b></dt><dd>A string that contains the cache root directory. </dd></dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l00972">972</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachea6" doxytag="HTTPCache::get_cached_response" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> FILE * HTTPCache::get_cached_response </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>url</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>vector&lt; string &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>headers</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throw (<a class="el" href="classError.html">Error</a>, <a class="el" href="classInternalErr.html">InternalErr</a>)</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get information from the cache. For a given URL, get the headers and body stored in the cache. Note that this method increments the hit counter for <code>url</code>'s entry and <em>locks</em> that entry. To release the lock, the method <a class="el" href="classHTTPCache.html#HTTPCachea8">release_cached_response()</a> <em>must</em> be called. Methods that block on a locked entry are: <a class="el" href="classHTTPCache.html#HTTPCachea2">get_conditional_request_headers()</a>, <a class="el" href="classHTTPCache.html#HTTPCachea3">update_response()</a> and <a class="el" href="classHTTPCache.html#HTTPCachea5">is_url_valid()</a>. In addition, <a class="el" href="classHTTPCache.html#HTTPCachea9">purge_cache()</a> throws <a class="el" href="classError.html">Error</a> if it's called and any entries are locked. The garbage collection system will not reclaim locked entries (but works fine when some entries are locked).<p>
This method locks the class' interface.<p>
This method does <em>not</em> check to see that the response is valid, just that it is in the cache. To see if a cached response is valid, use <a class="el" href="classHTTPCache.html#HTTPCachea5">is_url_valid()</a>. The FILE* returned can be used for both reading and writing. The latter allows a client to update the body of a cached response without having to first dump it all to a separate file and then copy it into the cache (using <a class="el" href="classHTTPCache.html#HTTPCachea1">cache_response()</a>).<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>url</em>&nbsp;</td><td>Get response information for this URL. </td></tr>
    <tr><td valign=top><em>headers</em>&nbsp;</td><td>Return the response headers in this parameter </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>A FILE * to the response body. </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Error</em>&nbsp;</td><td>Thrown if the URL's response is not in the cache. </td></tr>
    <tr><td valign=top><em>InternalErr</em>&nbsp;</td><td>Thrown if the persistent store cannot be opened. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l02101">2101</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="HTTPCache_8h-source.html#l00155">HTTPCache::CacheEntry::cachename</a>, <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8h-source.html#l00153">HTTPCache::CacheEntry::hits</a>, <a class="el" href="HTTPCache_8h-source.html#l00177">HTTPCache::CacheEntry::lock</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, <a class="el" href="HTTPCache_8h-source.html#l00175">HTTPCache::CacheEntry::locked</a>, <a class="el" href="HTTPCache_8cc-source.html#l00060">TRYLOCK</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachea7" doxytag="HTTPCache::get_cached_response_body" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> FILE * HTTPCache::get_cached_response_body </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const string &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>url</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>  throw (<a class="el" href="classError.html">Error</a>, <a class="el" href="classInternalErr.html">InternalErr</a>)</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get a pointer to a cached response body. For a given URL, find the cached response body and return a FILE * to it. This updates the hit counter and it locks the entry. To release the lock, call <a class="el" href="classHTTPCache.html#HTTPCachea8">release_cached_response()</a>. Methods that block on a locked entry are: <a class="el" href="classHTTPCache.html#HTTPCachea2">get_conditional_request_headers()</a>, <a class="el" href="classHTTPCache.html#HTTPCachea3">update_response()</a> and <a class="el" href="classHTTPCache.html#HTTPCachea5">is_url_valid()</a>. In addition, <a class="el" href="classHTTPCache.html#HTTPCachea9">purge_cache()</a> throws <a class="el" href="classError.html">Error</a> if it's called and any entries are locked. The garbage collection system will not reclaim locked entries (but works fine when some entries are locked).<p>
NB: This method does <em>not</em> check to see that the response is valid, just that it is in the cache. To see if a cached response is valid, use <a class="el" href="classHTTPCache.html#HTTPCachea5">is_url_valid()</a>.<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>url</em>&nbsp;</td><td>Find the body associated with this URL. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>A FILE* that points to the response body. </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Error</em>&nbsp;</td><td>Thrown if the URL is not in the cache. </td></tr>
    <tr><td valign=top><em>InternalErr</em>&nbsp;</td><td>Thrown if an I/O error is detected. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l02165">2165</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="HTTPCache_8h-source.html#l00155">HTTPCache::CacheEntry::cachename</a>, <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8h-source.html#l00153">HTTPCache::CacheEntry::hits</a>, <a class="el" href="HTTPCache_8h-source.html#l00177">HTTPCache::CacheEntry::lock</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, <a class="el" href="HTTPCache_8h-source.html#l00175">HTTPCache::CacheEntry::locked</a>, <a class="el" href="HTTPCache_8cc-source.html#l00060">TRYLOCK</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachea2" doxytag="HTTPCache::get_conditional_request_headers" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> vector&lt; string &gt; HTTPCache::get_conditional_request_headers </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const string &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>url</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>  throw (<a class="el" href="classError.html">Error</a>)</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Build the headers to send along with a GET request to make that request conditional. This method examines the headers for a given response in the cache and formulates the correct headers for a valid HTTP 1.1 conditional GET request. See RFC 2616, Section 13.3.4.<p>
Rules: If an ETag is present, it must be used. Use If-None-Match. If a Last-Modified header is present, use it. Use If-Modified-Since. If both are present, use both (this means that HTTP 1.0 daemons are more likely to work). If a Last-Modified header is not present, use the value of the Cache-Control max-age or Expires header(s). Note that a 'Cache-Control: max-age' header overrides an Expires header (Sec 14.9.3).<p>
This method locks the cache interface and the cache entry.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>url</em>&nbsp;</td><td>Get the <a class="el" href="structHTTPCache_1_1CacheEntry.html">CacheEntry</a> for this URL. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>A vector of strings, one request header per string. </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Error</em>&nbsp;</td><td>Thrown if the <em>url</em> is not in the cache. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01846">1846</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="util__mit_8cc-source.html#l00260">date_time_str()</a>, <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8h-source.html#l00157">HTTPCache::CacheEntry::etag</a>, <a class="el" href="HTTPCache_8h-source.html#l00159">HTTPCache::CacheEntry::expires</a>, <a class="el" href="HTTPCache_8h-source.html#l00158">HTTPCache::CacheEntry::lm</a>, <a class="el" href="HTTPCache_8h-source.html#l00177">HTTPCache::CacheEntry::lock</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, <a class="el" href="HTTPCache_8h-source.html#l00162">HTTPCache::CacheEntry::max_age</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_14" doxytag="HTTPCache::get_default_expiration" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> int HTTPCache::get_default_expiration </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the default expiration time used by the cache. 
<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01245">1245</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_12" doxytag="HTTPCache::get_max_entry_size" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned long HTTPCache::get_max_entry_size </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get the maximum size of an individual entry in the cache.<p>
<dl compact><dt><b>Returns:</b></dt><dd>The maximum size in megabytes. </dd></dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01215">1215</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="HTTPCache_8cc-source.html#l00114">MEGA</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_10" doxytag="HTTPCache::get_max_size" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> unsigned long HTTPCache::get_max_size </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
How big is the cache? The value returned is the size in megabytes. 
<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01159">1159</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="HTTPCache_8cc-source.html#l00114">MEGA</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachee0" doxytag="HTTPCache::instance" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> <a class="el" href="classHTTPCache.html">HTTPCache</a> * HTTPCache::instance </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>cache_root</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>bool&nbsp;</td>
          <td class="mdname" nowrap> <em>force</em> = false</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throw (<a class="el" href="classError.html">Error</a>)<code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Get a pointer to the HTTP 1.1 compliant cache. If not already instantiated, this creates an instance of the HTTP cache object and initializes it to use <code>cache_root</code> as the location of the persistent store. If there's an index (<code></code>.index) file in that directory, it is read as part of the initialization. If the cache has already been initialized, this method returns a pointer to that instance. Note HTTPCache uses the singleton pattern; A process may have only one instance of this object. Also note that HTTPCache is MT-safe. However, if the <code>force</code> parameter is set to true, it may be possible for two or more processes to access the persistent store at the same time resulting in undefined behavior.<p>
Default values: <a class="el" href="classHTTPCache.html#HTTPCachez35_2">is_cache_enabled()</a>: true, <a class="el" href="classHTTPCache.html#HTTPCachez35_4">is_cache_protected()</a>: false, <a class="el" href="classHTTPCache.html#HTTPCachez35_8">is_expire_ignored()</a>: false, the total size of the cache is 20M, 2M of that is reserved for response headers, during GC the cache is reduced to at least 18M (total size - 10% of the total size), and the max size for an individual entry is 3M. It is possible to change the size of the cache, but not to make it smaller than 5M. If expiration information is not sent with a response, it is assumed to expire in 24 hours.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>cache_root</em>&nbsp;</td><td>The fully qualified pathname of the directory which will hold the cache data (i.e., the persistent store). </td></tr>
    <tr><td valign=top><em>force</em>&nbsp;</td><td>Force access to the persistent store if true. By default false. Use this only if you're sure no one else is using the same cache root! This is included so that programs may use a cache that was left in an inconsistent state. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>A pointer to the HTTPCache object. </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Error</em>&nbsp;</td><td>thrown if the cache root cannot set. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l00224">224</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00064">DBG2</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.
<p>
Referenced by <a class="el" href="HTTPConnect_8cc-source.html#l00379">HTTPConnect::HTTPConnect()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_2" doxytag="HTTPCache::is_cache_enabled" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool HTTPCache::is_cache_enabled </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Is the cache currently enabled? 
<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01003">1003</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="debug_8h-source.html#l00064">DBG2</a>.
<p>
Referenced by <a class="el" href="HTTPConnect_8h-source.html#l00155">HTTPConnect::is_cache_enabled()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_4" doxytag="HTTPCache::is_cache_protected" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool HTTPCache::is_cache_protected </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Should we cache protected responses? 
<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01034">1034</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_8" doxytag="HTTPCache::is_expire_ignored" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool HTTPCache::is_expire_ignored </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap> const</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01093">1093</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachea4" doxytag="HTTPCache::is_url_in_cache" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool HTTPCache::is_url_in_cache </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const string &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>url</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Look in the cache for the given <code>url</code>. Is it in the cache table?<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>url</em>&nbsp;</td><td>The url to look for. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>True if <code>url</code> is found, otherwise False. </dd></dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01537">1537</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="debug_8h-source.html#l00057">DBG</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachea5" doxytag="HTTPCache::is_url_valid" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool HTTPCache::is_url_valid </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const string &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>url</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>  throw (<a class="el" href="classError.html">Error</a>)</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Look in the cache and return the status (validity) of the cached response. This method should be used to determine if a cached response requires validation.<p>
This method locks the class' interface and on a locked cache entry.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>url</em>&nbsp;</td><td>Find the cached response associated with this URL. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>True indicates that the response can be used, False indicates that it must first be validated. </dd></dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Error</em>&nbsp;</td><td>Thrown if the URL's response is not in the cache. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01994">1994</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="HTTPCache_8h-source.html#l00170">HTTPCache::CacheEntry::corrected_initial_age</a>, <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8h-source.html#l00168">HTTPCache::CacheEntry::freshness_lifetime</a>, <a class="el" href="HTTPCache_8h-source.html#l00177">HTTPCache::CacheEntry::lock</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, <a class="el" href="HTTPCache_8h-source.html#l00172">HTTPCache::CacheEntry::must_revalidate</a>, <a class="el" href="HTTPCache_8h-source.html#l00169">HTTPCache::CacheEntry::response_time</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachea9" doxytag="HTTPCache::purge_cache" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::purge_cache </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>  throw (<a class="el" href="classError.html">Error</a>)</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Purge both the in-memory cache table and the contents of the cache on disk. This method deletes every entry in the persistent store but leaves the structure intact. The client of HTTPCache is responsible for making sure that all threads have released any responses they pulled from the cache. If this method is called when a response is still in use, it will throw an <a class="el" href="classError.html">Error</a> object and not purge the cache.<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Error</em>&nbsp;</td><td>Thrown if an attempt is made to purge the cache when an entry is still in use. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l02281">2281</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="HTTPCache_8h-source.html#l00076">CACHE_TABLE_SIZE</a>, <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachea8" doxytag="HTTPCache::release_cached_response" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::release_cached_response </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">FILE *&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>body</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>  throw (<a class="el" href="classError.html">Error</a>)</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Call this method to inform the cache that a particular response is no longer in use. When a response is accessed using <a class="el" href="classHTTPCache.html#HTTPCachea6">get_cached_response()</a>, it is locked so that updates and removal (e.g., by the garbage collector) are not possible. Calling this method frees that lock.<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>body</em>&nbsp;</td><td>Release the lock on the response information associated with this FILE *. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Error</em>&nbsp;</td><td>Thrown if <code>body</code> does not belong to an entry in the cache or if the entry was already released. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l02220">2220</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8h-source.html#l00177">HTTPCache::CacheEntry::lock</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, <a class="el" href="HTTPCache_8h-source.html#l00175">HTTPCache::CacheEntry::locked</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.
<p>
Referenced by <a class="el" href="HTTPCacheResponse_8h-source.html#l00066">HTTPCacheResponse::~HTTPCacheResponse()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_15" doxytag="HTTPCache::set_always_validate" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::set_always_validate </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">bool&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>validate</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Should every cache entry be validated? <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>validate</em>&nbsp;</td><td>True if every cache entry should be validated before being used. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01255">1255</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_17" doxytag="HTTPCache::set_cache_control" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::set_cache_control </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const vector&lt; string &gt; &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cc</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap>  throw (<a class="el" href="classInternalErr.html">InternalErr</a>)</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the request Cache-Control headers. If a request must be satisfied using HTTP, these headers should be included in request since they might be pertinent to a proxy cache.<p>
Ignored headers: no-transform, only-if-cached. These headers are not used by HTTPCache and are not recorded. However, if present in the vector passed to this method, they will be present in the vector returned by get_cache_control.<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>cc</em>&nbsp;</td><td>A vector of strings, each string holds one Cache-Control header. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>InternalErr</em>&nbsp;</td><td>Thrown if one of the strings in <code>cc</code> does not start with 'Cache-Control: '. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01286">1286</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, <a class="el" href="util__mit_8cc-source.html#l00123">parse_time()</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_5" doxytag="HTTPCache::set_cache_disconnected" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::set_cache_disconnected </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top"><a class="el" href="HTTPCacheDisconnectedMode_8h.html#a3">CacheDisconnectedMode</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>mode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the cache's disconnected property. The cache can operate either disconnected from the network or using a proxy cache (but tell that proxy not to use the network).<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>mode</em>&nbsp;</td><td>One of DISCONNECT_NONE, DISCONNECT_NORMAL or DISCONNECT_EXTERNAL. </td></tr>
  </table>
</dl>
<dl compact><dt><b>See also:</b></dt><dd>CacheDIsconnectedMode </dd></dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01050">1050</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_1" doxytag="HTTPCache::set_cache_enabled" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::set_cache_enabled </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">bool&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>mode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Enable or disable the cache. The cache can be temporarily suspended using the enable/disable property. This does not prevent the cache from being enabled/disable at a later point in time.<p>
Default: yes<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>mode</em>&nbsp;</td><td>True if the cache should be enabled, False if it should be disabled. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l00989">989</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.
<p>
Referenced by <a class="el" href="HTTPConnect_8h-source.html#l00149">HTTPConnect::set_cache_enabled()</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_3" doxytag="HTTPCache::set_cache_protected" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::set_cache_protected </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">bool&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>mode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Should we cache protected responses? A protected response is one that comes from a server/site that requires authorization.<p>
Default: no<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>mode</em>&nbsp;</td><td>True if protected responses should be cached. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01020">1020</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_13" doxytag="HTTPCache::set_default_expiration" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::set_default_expiration </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">int&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>exp_time</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the default expiration time. Use the <em>default expiration</em> property to determine when a cached response becomes stale if the response lacks the information necessary to compute a specific value.<p>
Default: 24 hours (86,400 seconds)<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>exp_time</em>&nbsp;</td><td>The time in seconds. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01231">1231</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_7" doxytag="HTTPCache::set_expire_ignored" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::set_expire_ignored </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">bool&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>mode</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
How should the cache handle the Expires header? Default: no<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>mode</em>&nbsp;</td><td>True if a responses Expires header should be ignored, False otherwise. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01078">1078</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_11" doxytag="HTTPCache::set_max_entry_size" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::set_max_entry_size </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned long&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>size</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Set the maximum size for a single entry in the cache.<p>
Default: 3M<p>
This method locks the class' interface.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>size</em>&nbsp;</td><td>The size in megabytes. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01173">1173</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="HTTPCache_8cc-source.html#l00469">cache_index_write()</a>, <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00064">DBG2</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, <a class="el" href="HTTPCache_8cc-source.html#l00114">MEGA</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachez35_9" doxytag="HTTPCache::set_max_size" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::set_max_size </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">unsigned long&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>size</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Cache size management. The default cache size is 20M. The minimum size is 5M in order not to get into weird problems while writing the cache. The size is indicated in Mega bytes. Note that reducing the size of the cache may trigger a garbage collection operation.<p>
<dl compact><dt><b>Note:</b></dt><dd>The maximum cache size is UINT_MAX bytes (usually 4294967295 for 32-bit computers). If <em>size</em> is larger the value will be truncated to the value of that constant. It seems pretty unlikely that will happen given that the parameter is an unsigned long. This is a fix for bug 689 which was reported when the parameter type was signed.</dd></dl>
This method locks the class' interface.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>size</em>&nbsp;</td><td>The maximum size of the cache in megabytes. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01114">1114</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="HTTPCache_8cc-source.html#l00116">CACHE_FOLDER_PCT</a>, <a class="el" href="HTTPCache_8cc-source.html#l00117">CACHE_GC_PCT</a>, <a class="el" href="HTTPCache_8cc-source.html#l00469">cache_index_write()</a>, <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00064">DBG2</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, <a class="el" href="HTTPCache_8cc-source.html#l00114">MEGA</a>, <a class="el" href="HTTPCache_8cc-source.html#l00118">MIN_CACHE_TOTAL_SIZE</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachea3" doxytag="HTTPCache::update_response" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void HTTPCache::update_response </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>url</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>time_t&nbsp;</td>
          <td class="mdname" nowrap> <em>request_time</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const vector&lt; string &gt; &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>headers</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2">  throw (<a class="el" href="classError.html">Error</a>)</td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Update the meta data for a response already in the cache. This method provides a way to merge response headers returned from a conditional GET request, for the given URL, with those already present.<p>
This method locks the class' interface and the cache entry.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>url</em>&nbsp;</td><td>Update the meta data for this cache entry. </td></tr>
    <tr><td valign=top><em>request_time</em>&nbsp;</td><td>The time (Unix time, seconds since 1 Jan 1970) that the conditional request was made. </td></tr>
    <tr><td valign=top><em>headers</em>&nbsp;</td><td>New headers, one header per string, returned in the response. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Exceptions:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>Error</em>&nbsp;</td><td>Thrown if the <code>url</code> is not in the cache. </td></tr>
  </table>
</dl>

<p>
Definition at line <a class="el" href="HTTPCache_8cc-source.html#l01917">1917</a> of file <a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a>.
<p>
References <a class="el" href="HTTPCache_8h-source.html#l00155">HTTPCache::CacheEntry::cachename</a>, <a class="el" href="debug_8h-source.html#l00057">DBG</a>, <a class="el" href="debug_8h-source.html#l00058">DBGN</a>, <a class="el" href="HTTPCache_8h-source.html#l00177">HTTPCache::CacheEntry::lock</a>, <a class="el" href="HTTPCache_8cc-source.html#l00059">LOCK</a>, and <a class="el" href="HTTPCache_8cc-source.html#l00061">UNLOCK</a>.    </td>
  </tr>
</table>
<hr><h2>Friends And Related Function Documentation</h2>
<a class="anchor" name="HTTPCachen2" doxytag="HTTPCache::DeleteByHits" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> friend class DeleteByHits<code> [friend]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="HTTPCache_8h-source.html#l00264">264</a> of file <a class="el" href="HTTPCache_8h-source.html">HTTPCache.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachen3" doxytag="HTTPCache::DeleteCacheEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> friend class DeleteCacheEntry<code> [friend]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="HTTPCache_8h-source.html#l00265">265</a> of file <a class="el" href="HTTPCache_8h-source.html">HTTPCache.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachen1" doxytag="HTTPCache::DeleteExpired" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> friend class DeleteExpired<code> [friend]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="HTTPCache_8h-source.html#l00263">263</a> of file <a class="el" href="HTTPCache_8h-source.html">HTTPCache.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachen4" doxytag="HTTPCache::DeleteUnlockedCacheEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> friend class DeleteUnlockedCacheEntry<code> [friend]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="HTTPCache_8h-source.html#l00266">266</a> of file <a class="el" href="HTTPCache_8h-source.html">HTTPCache.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachen0" doxytag="HTTPCache::HTTPCacheTest" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> friend class HTTPCacheTest<code> [friend]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="HTTPCache_8h-source.html#l00259">259</a> of file <a class="el" href="HTTPCache_8h-source.html">HTTPCache.h</a>.    </td>
  </tr>
</table>
<a class="anchor" name="HTTPCachen5" doxytag="HTTPCache::WriteOneCacheEntry" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> friend class WriteOneCacheEntry<code> [friend]</code>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="HTTPCache_8h-source.html#l00267">267</a> of file <a class="el" href="HTTPCache_8h-source.html">HTTPCache.h</a>.    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="HTTPCache_8h-source.html">HTTPCache.h</a><li><a class="el" href="HTTPCache_8cc-source.html">HTTPCache.cc</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Wed Feb 4 23:45:03 2004 for libdap++ by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
